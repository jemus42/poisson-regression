<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de-DE" xml:lang="de-DE">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Kapitel 4 Weitere Modelle | Poisson-Regression und ihre Leiden</title>
  <meta name="description" content="Because count data is hard" />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="Kapitel 4 Weitere Modelle | Poisson-Regression und ihre Leiden" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/poiscovr-orly.png" />
  <meta property="og:description" content="Because count data is hard" />
  <meta name="github-repo" content="jemus42/poisson-regression" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Kapitel 4 Weitere Modelle | Poisson-Regression und ihre Leiden" />
  
  <meta name="twitter:description" content="Because count data is hard" />
  <meta name="twitter:image" content="images/poiscovr-orly.png" />

<meta name="author" content="Lukas Burk" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multiparam.html"/>
<link rel="next" href="anwendung.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="libs/viz-0.3/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.1/grViz.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { fonts: ["Asana-Math"] },
    MathMenu: { showFontMenu: true },
    menuSettings: { zoom: "Click" }
  });
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Poisson Regression</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Einführung</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#data"><i class="fa fa-check"></i><b>1.1</b> Beispieldaten</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#software-funs"><i class="fa fa-check"></i><b>1.2</b> Verwendete Software</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#r-packages"><i class="fa fa-check"></i><b>1.2.1</b> R-Packages</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#helperfuns"><i class="fa fa-check"></i><b>1.2.2</b> Funktionen</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="poisson-modell.html"><a href="poisson-modell.html"><i class="fa fa-check"></i><b>2</b> Das Poisson-Modell</a><ul>
<li class="chapter" data-level="2.1" data-path="poisson-modell.html"><a href="poisson-modell.html#annahmen"><i class="fa fa-check"></i><b>2.1</b> Annahmen</a></li>
<li class="chapter" data-level="2.2" data-path="poisson-modell.html"><a href="poisson-modell.html#dispersion"><i class="fa fa-check"></i><b>2.2</b> Dispersion</a><ul>
<li class="chapter" data-level="2.2.1" data-path="poisson-modell.html"><a href="poisson-modell.html#overdispersion"><i class="fa fa-check"></i><b>2.2.1</b> Overdispersion</a></li>
<li class="chapter" data-level="2.2.2" data-path="poisson-modell.html"><a href="poisson-modell.html#underdispersion"><i class="fa fa-check"></i><b>2.2.2</b> Underdispersion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="multiparam.html"><a href="multiparam.html"><i class="fa fa-check"></i><b>3</b> Mehrparametrische Modelle</a><ul>
<li class="chapter" data-level="3.1" data-path="multiparam.html"><a href="multiparam.html#mod-nb"><i class="fa fa-check"></i><b>3.1</b> Negativ Binomial (NB)</a></li>
<li class="chapter" data-level="3.2" data-path="multiparam.html"><a href="multiparam.html#mod-pig"><i class="fa fa-check"></i><b>3.2</b> Poisson Inverse Gaussian (PIG)</a></li>
<li class="chapter" data-level="3.3" data-path="multiparam.html"><a href="multiparam.html#mod-gp"><i class="fa fa-check"></i><b>3.3</b> Generalized Poisson (GP)</a></li>
<li class="chapter" data-level="3.4" data-path="multiparam.html"><a href="multiparam.html#mod-comp"><i class="fa fa-check"></i><b>3.4</b> Conway-Maxwell Poisson (COMP)</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="weitere-modelle.html"><a href="weitere-modelle.html"><i class="fa fa-check"></i><b>4</b> Weitere Modelle</a><ul>
<li class="chapter" data-level="4.1" data-path="weitere-modelle.html"><a href="weitere-modelle.html#diagnostische-modelle"><i class="fa fa-check"></i><b>4.1</b> Diagnostische Modelle</a><ul>
<li class="chapter" data-level="4.1.1" data-path="weitere-modelle.html"><a href="weitere-modelle.html#mod-nbh"><i class="fa fa-check"></i><b>4.1.1</b> Heterogenous Negative Binomial (NBH)</a></li>
<li class="chapter" data-level="4.1.2" data-path="weitere-modelle.html"><a href="weitere-modelle.html#mod-nbp"><i class="fa fa-check"></i><b>4.1.2</b> Negative binomial-P (NB-P)</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="weitere-modelle.html"><a href="weitere-modelle.html#mod-zi"><i class="fa fa-check"></i><b>4.2</b> Zero-Inflated Models (<em>mixture models</em>)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="anwendung.html"><a href="anwendung.html"><i class="fa fa-check"></i><b>5</b> Anwendung</a><ul>
<li class="chapter" data-level="5.1" data-path="anwendung.html"><a href="anwendung.html#overdisp-diag"><i class="fa fa-check"></i><b>5.1</b> Overdispersion: Erkennung und Handhabung</a><ul>
<li class="chapter" data-level="5.1.1" data-path="anwendung.html"><a href="anwendung.html#boundary-likelihood-ratio-test-blr"><i class="fa fa-check"></i><b>5.1.1</b> (Boundary) Likelihood Ratio Test (BLR)</a></li>
<li class="chapter" data-level="5.1.2" data-path="anwendung.html"><a href="anwendung.html#umgang-mit-overdispersion"><i class="fa fa-check"></i><b>5.1.2</b> Umgang mit Overdispersion</a><ul>
<li class="chapter" data-level="5.1.2.1" data-path="anwendung.html"><a href="anwendung.html#sandwich"><i class="fa fa-check"></i><b>5.1.2.1</b> Robuste Varianzschätzer (Sandwich Estimators)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="anwendung.html"><a href="anwendung.html#zeros"><i class="fa fa-check"></i><b>5.2</b> Zero-Inflation (ZI)</a><ul>
<li class="chapter" data-level="" data-path="anwendung.html"><a href="anwendung.html#tests-auf-zero-inflation"><i class="fa fa-check"></i>Tests auf Zero-Inflation</a></li>
<li class="chapter" data-level="" data-path="anwendung.html"><a href="anwendung.html#modellierung"><i class="fa fa-check"></i>Modellierung</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="entscheidungshilfen.html"><a href="entscheidungshilfen.html"><i class="fa fa-check"></i><b>6</b> Entscheidungshilfen</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="erganzungen.html"><a href="erganzungen.html"><i class="fa fa-check"></i><b>A</b> Ergänzungen</a><ul>
<li class="chapter" data-level="A.1" data-path="erganzungen.html"><a href="erganzungen.html#appendix-missingness"><i class="fa fa-check"></i><b>A.1</b> Missing values und missingness patterns</a></li>
<li class="chapter" data-level="A.2" data-path="erganzungen.html"><a href="erganzungen.html#trunc-cens"><i class="fa fa-check"></i><b>A.2</b> Truncation und Censoring</a></li>
<li class="chapter" data-level="A.3" data-path="erganzungen.html"><a href="erganzungen.html#mod-hurdle"><i class="fa fa-check"></i><b>A.3</b> Hurdle models</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="repro.html"><a href="repro.html"><i class="fa fa-check"></i><b>B</b> Reproduzierbarkeit</a><ul>
<li class="chapter" data-level="B.1" data-path="repro.html"><a href="repro.html#r-code"><i class="fa fa-check"></i><b>B.1</b> R-Code</a></li>
<li class="chapter" data-level="B.2" data-path="repro.html"><a href="repro.html#session-info"><i class="fa fa-check"></i><b>B.2</b> Session Info</a></li>
<li class="chapter" data-level="B.3" data-path="repro.html"><a href="repro.html#unsorted"><i class="fa fa-check"></i><b>B.3</b> Unsorted</a><ul>
<li class="chapter" data-level="B.3.1" data-path="repro.html"><a href="repro.html#general-advice"><i class="fa fa-check"></i><b>B.3.1</b> General Advice</a></li>
<li class="chapter" data-level="B.3.2" data-path="repro.html"><a href="repro.html#beispiel-nach-hilbemodelingcountdata2014-p.211ff"><i class="fa fa-check"></i><b>B.3.2</b> Beispiel nach <span class="citation">Hilbe (<a href="#ref-hilbeModelingCountData2014">2014</a>)</span>, p. 211ff</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="literatur.html"><a href="literatur.html"><i class="fa fa-check"></i>Literatur</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Built with bookdown</a></li>
<li><a href="https://git.tadaa-data.de/lukas/poisson-regression" target="blank">Source on Gitea</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Poisson-Regression und ihre Leiden</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="weitere-modelle" class="section level1">
<h1><span class="header-section-number">Kapitel 4</span> Weitere Modelle</h1>
<div id="diagnostische-modelle" class="section level2">
<h2><span class="header-section-number">4.1</span> Diagnostische Modelle</h2>
<div id="mod-nbh" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Heterogenous Negative Binomial (NBH)</h3>
<ul>
<li>Selling feature: Erlaubt Parametrisierung von <span class="math inline">\(\alpha\)</span></li>
<li>-&gt; Ursache für under-/overdispersion modellierbar</li>
</ul>
<p><span class="citation">Hilbe (<a href="#ref-hilbeModelingCountData2014">2014</a>)</span> (p. 156)</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">data</span>(nuts, <span class="dt">package =</span> <span class="st">&quot;COUNT&quot;</span>)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2">nuts &lt;-<span class="st"> </span><span class="kw">subset</span>(nuts, dbh <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.6</span>)</a>
<a class="sourceLine" id="cb16-3" data-line-number="3"></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="kw">ggplot</span>(<span class="dt">data =</span> nuts, <span class="kw">aes</span>(<span class="dt">x =</span> cones)) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="poisson-regression_files/figure-html/nbh-1.png" width="768" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="co"># Poisson-Modell als Startpunkt</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2">m_pois &lt;-<span class="st"> </span><span class="kw">glm</span>(cones <span class="op">~</span><span class="st"> </span>sntrees <span class="op">+</span><span class="st"> </span>sheight <span class="op">+</span><span class="st"> </span>scover, <span class="dt">family =</span> <span class="kw">poisson</span>(), <span class="dt">data =</span> nuts) </a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="kw">dispersion</span>(m_pois) <span class="co"># -&gt; overdispersion </span></a></code></pre></div>
<pre><code>#&gt; X-squared(47) = 643.01
#&gt; Pearson Dispersion = 13.681</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="co"># NB-Modell</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2">m_nb &lt;-<span class="st"> </span>msme<span class="op">::</span><span class="kw">nbinomial</span>(cones <span class="op">~</span><span class="st"> </span>sntrees <span class="op">+</span><span class="st"> </span>sheight <span class="op">+</span><span class="st"> </span>scover, <span class="dt">data =</span> nuts)</a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="kw">summary</span>(m_nb) <span class="co"># Dispersion &lt; 1 -&gt; NB-underdispersed</span></a></code></pre></div>
<pre><code>#&gt; 
#&gt; Call:
#&gt; ml_glm2(formula1 = formula1, formula2 = formula2, data = data, 
#&gt;     family = family, mean.link = mean.link, scale.link = scale.link, 
#&gt;     offset = offset, start = start, verbose = verbose)
#&gt; 
#&gt; Deviance Residuals:
#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#&gt; -2.4506 -1.0501 -0.4199 -0.3294  0.3910  1.6464 
#&gt; 
#&gt; Pearson Residuals:
#&gt;       Min.    1st Qu.     Median       Mean    3rd Qu.       Max. 
#&gt; -1.0061432 -0.7292929 -0.3653465  0.0003247  0.4433920  2.6100790 
#&gt; 
#&gt; Coefficients (all in linear predictor):
#&gt;               Estimate    SE     Z        p      LCL   UCL
#&gt; (Intercept)      2.627 0.142 18.53 1.24e-76  2.34948 2.905
#&gt; sntrees          0.306 0.161  1.90   0.0573 -0.00945 0.621
#&gt; sheight          0.158 0.159  0.99    0.322 -0.15463 0.470
#&gt; scover           0.536 0.179  3.00  0.00274  0.18516 0.886
#&gt; (Intercept)_s    0.927 0.199  4.65 3.37e-06  0.53584 1.318
#&gt; 
#&gt; Null deviance: 77.26177  on  49 d.f.
#&gt; Residual deviance: 59.07252  on  46 d.f.
#&gt; Null Pearson: 58.54636  on  49 d.f.
#&gt; Residual Pearson: 41.19523  on  46 d.f.
#&gt; Dispersion: 0.8955486
#&gt; AIC:  383.8132
#&gt; 
#&gt; Number of optimizer iterations:  53</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="co"># NB-H: Ursache der Dispersion?</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2">m_nbh &lt;-<span class="st"> </span>msme<span class="op">::</span><span class="kw">nbinomial</span>(cones <span class="op">~</span><span class="st"> </span>sntrees <span class="op">+</span><span class="st"> </span>sheight <span class="op">+</span><span class="st"> </span>scover, </a>
<a class="sourceLine" id="cb21-3" data-line-number="3">                         <span class="dt">formula2 =</span> cones <span class="op">~</span><span class="st"> </span>sntrees <span class="op">+</span><span class="st"> </span>sheight <span class="op">+</span><span class="st"> </span>scover,</a>
<a class="sourceLine" id="cb21-4" data-line-number="4">                         <span class="dt">scale.link =</span> <span class="st">&quot;log_s&quot;</span>,</a>
<a class="sourceLine" id="cb21-5" data-line-number="5">                         <span class="dt">family =</span> <span class="st">&quot;negBinomial&quot;</span>,</a>
<a class="sourceLine" id="cb21-6" data-line-number="6">                         <span class="dt">data =</span> nuts)</a>
<a class="sourceLine" id="cb21-7" data-line-number="7"><span class="kw">summary</span>(m_nbh)</a></code></pre></div>
<pre><code>#&gt; 
#&gt; Call:
#&gt; ml_glm2(formula1 = formula1, formula2 = formula2, data = data, 
#&gt;     family = family, mean.link = mean.link, scale.link = scale.link, 
#&gt;     offset = offset, start = start, verbose = verbose)
#&gt; 
#&gt; Deviance Residuals:
#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#&gt; -2.7908 -0.9137 -0.3023 -0.3208  0.4419  1.5671 
#&gt; 
#&gt; Pearson Residuals:
#&gt;     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
#&gt; -1.14680 -0.70958 -0.23947  0.03088  0.31546  3.20165 
#&gt; 
#&gt; Coefficients (all in linear predictor):
#&gt;               Estimate    SE      Z        p     LCL   UCL
#&gt; (Intercept)     2.6147 0.144 18.159  1.1e-73  2.3325 2.897
#&gt; sntrees         0.2731 0.110  2.478   0.0132  0.0571 0.489
#&gt; sheight         0.0744 0.144  0.516    0.606 -0.2081 0.357
#&gt; scover          0.5217 0.158  3.300 0.000967  0.2118 0.832
#&gt; (Intercept)_s  -0.1950 0.238 -0.821    0.412 -0.6608 0.271
#&gt; sntrees_s      -0.3834 0.323 -1.186    0.236 -1.0168 0.250
#&gt; sheight_s       0.3312 0.321  1.033    0.302 -0.2973 0.960
#&gt; scover_s        0.2723 0.417  0.652    0.514 -0.5459 1.091
#&gt; 
#&gt; Null deviance: 85.07187  on  49 d.f.
#&gt; Residual deviance: 59.49816  on  43 d.f.
#&gt; Null Pearson: 45.30266  on  49 d.f.
#&gt; Residual Pearson: 46.82167  on  43 d.f.
#&gt; Dispersion: 1.088876
#&gt; AIC:  385.7116
#&gt; 
#&gt; Number of optimizer iterations:  54</code></pre>
<p>Signifikanz der Dispersionsprädiktoren (Suffix <code>_s</code>) kann nun verwendet werden, um Ursachen der overdispersion zu identifizieren – auch wenn in diesem Beispiel keiner der Koeffizienten signifikant wird.</p>
</div>
<div id="mod-nbp" class="section level3">
<h3><span class="header-section-number">4.1.2</span> Negative binomial-P (NB-P)</h3>
<p>Eine Erweiterung der NB1 und NB2, die den Exponenten im Varianzterm parametrisiert, womit die Dispersion nun nicht mehr statisch für alle Beobachtungen ist:</p>

<p>Damit ist NB-P äquivalent zu NB2 für <span class="math inline">\(\rho = 2\)</span> bzw. NB1 für <span class="math inline">\(\rho = 1\)</span>.<br />
Um zu evaluieren, ob ein NB1 oder NB2 Modell einen besseren Fit liefert, kann man nun ein NB-P Modell zum Vergleich fitten und Likelihood Ratio Tests zum Vergleich heranziehen.</p>
<p>Siehe auch <span class="citation">Hilbe (<a href="#ref-hilbeModelingCountData2014">2014</a>)</span> (p. 155) – wo der Autor zwar den obigen Ansatz beschreibt, aber zur Entscheidung zwischen NB1/2 zusätzlich auf die sowieso etablierten Informationskriteren (AIC/BIC) zurückgreift. Dazu gehört auch, dass das NB-P kein rein diagnostisches Werkzeug sein muss: Wenn ein NB-P ein <em>deutlich</em> kleineres AIC aufweist als NB1/2-Modelle, kann das NB-P auch als Modell der Wahl in Erwägung gezogen werden.</p>
</div>
</div>
<div id="mod-zi" class="section level2">
<h2><span class="header-section-number">4.2</span> Zero-Inflated Models (<em>mixture models</em>)</h2>
<ul>
<li>Logit/Probit Komponente für zeros
<ul>
<li>Unterschied zu hurdle: Modelliert Nullen im Gegensatz zu Einsen</li>
</ul></li>
<li>Binary zeros und count zeros werden durch beide Komponenten modelliert
<ul>
<li>-&gt; Nicht getrennt interpretierbar wie bei hurdle models der Fall ist</li>
</ul></li>
<li>-&gt; Erzeugen eigene PDF, e.g. ZIP, die mixture aus beiden Komponenten darstellt</li>
</ul>
<p>ZIP und ZINB wurde hergeleitet als zweiteilige mixture distributions. Die allgemeine Form für mixture distributions ist</p>

<p>mit <span class="math inline">\(p\)</span> als <em>mixture proportion</em> und <span class="math inline">\(g_1, g_2\)</span> als Dichte-/Massefunktionen der beiden Komponenten.</p>
<p>In dieser Darstellung entspricht <span class="math inline">\(p\)</span> der <em>rate of zero-inflation</em> <span class="math inline">\(\pi\)</span>, <span class="math inline">\(g_1\)</span> einer degenerierten 0-Verteilung und <span class="math inline">\(g_2\)</span> einer Poisson-PMF.</p>

<div class="definition">
<p><span id="def:defzip" class="definition"><strong>Definition 4.1  (Zero-Inflated Poisson Verteilung (ZIP))  </strong></span>Nach <span class="citation">Perumean-Chaney u. a. (<a href="#ref-perumean-chaneyZeroinflatedOverdispersedWhat2013">2013</a>)</span> (p. 1675)</p>
<span class="math display">\[\begin{align*}
P(Y = 0) &amp;= \pi + (1-\pi) \cdot e^{-\mu} \\
P(Y = y) &amp;= (1 - \pi) \cdot \frac{\mu^y e^{-\mu}}{y!}, \quad y = 1, 2, 3, \ldots
\end{align*}\]</span>
</div>


<div class="definition">
<p><span id="def:defzinb" class="definition"><strong>Definition 4.2  (Zero-Inflated Negative Binomialverteilung (ZINB))  </strong></span>Nach <span class="citation">Perumean-Chaney u. a. (<a href="#ref-perumean-chaneyZeroinflatedOverdispersedWhat2013">2013</a>)</span> (p. 1675)</p>
<span class="math display">\[\begin{align*}
P(Y = 0) &amp;= \pi + (1 - \pi) \cdot \frac{\theta^\theta}{(\theta + \mu)^\theta}  \\
P(Y = y) &amp;= (1 - \pi) \cdot \frac{\Gamma(\theta+y)}{\Gamma(\theta) \Gamma(y + 1)} \frac{\theta^\theta \mu^y}{(\theta + \mu)^{(\theta + y)}}, \quad y = 1, 2, 3, \ldots
\end{align*}\]</span>
</div>

<p>Die ZI-Modelle sind dabei <strong>geschachtelt</strong> mit ihren ursprünglichen Modellen, da sich letzteres für bestimmte <span class="math inline">\(\pi\)</span> (auch wenn nicht <span class="math inline">\(\pi = 0\)</span>) aus dem ZI-Modell ergeben.<br />
Dieser Umstand ist Teil der Kritik an der Verwendung des Vuong-Test (entworfen für den Vergleich von <em><strong>un</strong>geschachtelten</em> Modellen) von <span class="citation">Wilson (<a href="#ref-wilson2015MisuseVuong">2015</a>)</span>, der sich gegen die Verwendung des Tests ausspricht um die Modellanpassung von Modellen mit ihren ZI-Gegenstücken zu vergleichen (siehe z.B. <span class="citation">Perumean-Chaney u. a. (<a href="#ref-perumean-chaneyZeroinflatedOverdispersedWhat2013">2013</a>)</span> für eine solche Anwendung des Vuong-Tests).</p>

</div>
</div>
<h3>Literatur</h3>
<div id="refs" class="references">
<div id="ref-hilbeModelingCountData2014">
<p>Hilbe, Joseph M. 2014. <em>Modeling Count Data</em>. Cambridge: Cambridge University Press. <a href="https://doi.org/10.1017/CBO9781139236065" class="uri">https://doi.org/10.1017/CBO9781139236065</a>.</p>
</div>
<div id="ref-perumean-chaneyZeroinflatedOverdispersedWhat2013">
<p>Perumean-Chaney, Suzanne E., Charity Morgan, David McDowall, und Inmaculada Aban. 2013. „Zero-Inflated and Overdispersed: What’s One to Do?“ <em>Journal of Statistical Computation and Simulation</em> 83 (9): 1671–83. <a href="https://doi.org/10.1080/00949655.2012.668550" class="uri">https://doi.org/10.1080/00949655.2012.668550</a>.</p>
</div>
<div id="ref-wilson2015MisuseVuong">
<p>Wilson, Paul. 2015. „The Misuse of the Vuong Test for Non-Nested Models to Test for Zero-Inflation“. <em>Economics Letters</em> 127 (Februar): 51–53. <a href="https://doi.org/10.1016/j.econlet.2014.12.029" class="uri">https://doi.org/10.1016/j.econlet.2014.12.029</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multiparam.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="anwendung.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["poisson-regression.pdf", "poisson-regression.tex"],
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
