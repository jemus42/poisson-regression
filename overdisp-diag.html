<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de-DE" xml:lang="de-DE">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.1 Overdispersion: Erkennung und Handhabung | Poisson-Regression und ihre Leiden</title>
  <meta name="description" content="Because count data is hard" />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="4.1 Overdispersion: Erkennung und Handhabung | Poisson-Regression und ihre Leiden" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="includes/images/poiscovr-orly.png" />
  <meta property="og:description" content="Because count data is hard" />
  <meta name="github-repo" content="jemus42/poisson-regression" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.1 Overdispersion: Erkennung und Handhabung | Poisson-Regression und ihre Leiden" />
  
  <meta name="twitter:description" content="Because count data is hard" />
  <meta name="twitter:image" content="includes/images/poiscovr-orly.png" />

<meta name="author" content="Lukas Burk" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="anwendung.html"/>
<link rel="next" href="zeros.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="libs/viz-0.3/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.1/grViz.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { fonts: ["Asana-Math"] },
    MathMenu: { showFontMenu: true },
    menuSettings: { zoom: "Click" }
  });
</script>
<link href="https://fonts.googleapis.com/css?family=Roboto|Roboto+Condensed|Roboto+Slab&display=swap" rel="stylesheet">


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="includes/css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Poisson Regression</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Einführung</a><ul>
<li class="chapter" data-level="1.1" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>1.1</b> Beispieldaten</a></li>
<li class="chapter" data-level="1.2" data-path="software-funs.html"><a href="software-funs.html"><i class="fa fa-check"></i><b>1.2</b> Verwendete Software</a><ul>
<li class="chapter" data-level="1.2.1" data-path="software-funs.html"><a href="software-funs.html#r-packages"><i class="fa fa-check"></i><b>1.2.1</b> R-Packages</a></li>
<li class="chapter" data-level="1.2.2" data-path="software-funs.html"><a href="software-funs.html#helperfuns"><i class="fa fa-check"></i><b>1.2.2</b> Funktionen</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="poisson-modell.html"><a href="poisson-modell.html"><i class="fa fa-check"></i><b>2</b> Das Poisson-Modell</a><ul>
<li class="chapter" data-level="2.1" data-path="annahmen.html"><a href="annahmen.html"><i class="fa fa-check"></i><b>2.1</b> Annahmen</a></li>
<li class="chapter" data-level="2.2" data-path="dispersion.html"><a href="dispersion.html"><i class="fa fa-check"></i><b>2.2</b> Dispersion</a><ul>
<li class="chapter" data-level="2.2.1" data-path="dispersion.html"><a href="dispersion.html#overdispersion"><i class="fa fa-check"></i><b>2.2.1</b> Overdispersion</a></li>
<li class="chapter" data-level="2.2.2" data-path="dispersion.html"><a href="dispersion.html#underdispersion"><i class="fa fa-check"></i><b>2.2.2</b> Underdispersion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="multiparam.html"><a href="multiparam.html"><i class="fa fa-check"></i><b>3</b> Mehrparametrische Modelle</a><ul>
<li class="chapter" data-level="3.1" data-path="mod-nb.html"><a href="mod-nb.html"><i class="fa fa-check"></i><b>3.1</b> Negativ Binomial (NB)</a></li>
<li class="chapter" data-level="3.2" data-path="mod-pig.html"><a href="mod-pig.html"><i class="fa fa-check"></i><b>3.2</b> Poisson Inverse Gaussian (PIG)</a></li>
<li class="chapter" data-level="3.3" data-path="mod-gp.html"><a href="mod-gp.html"><i class="fa fa-check"></i><b>3.3</b> Generalized Poisson (GP)</a></li>
<li class="chapter" data-level="3.4" data-path="mod-comp.html"><a href="mod-comp.html"><i class="fa fa-check"></i><b>3.4</b> Conway-Maxwell Poisson (COMP)</a></li>
<li class="chapter" data-level="3.5" data-path="diagnostische-modelle.html"><a href="diagnostische-modelle.html"><i class="fa fa-check"></i><b>3.5</b> Diagnostische Modelle</a><ul>
<li class="chapter" data-level="3.5.1" data-path="diagnostische-modelle.html"><a href="diagnostische-modelle.html#mod-nbh"><i class="fa fa-check"></i><b>3.5.1</b> Heterogenous Negative Binomial (NBH)</a></li>
<li class="chapter" data-level="3.5.2" data-path="diagnostische-modelle.html"><a href="diagnostische-modelle.html#mod-nbp"><i class="fa fa-check"></i><b>3.5.2</b> Negative binomial-P (NB-P)</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="mod-zi.html"><a href="mod-zi.html"><i class="fa fa-check"></i><b>3.6</b> Zero-Inflated Models (<em>mixture models</em>)</a><ul>
<li class="chapter" data-level="3.6.1" data-path="mod-zi.html"><a href="mod-zi.html#interpretation"><i class="fa fa-check"></i><b>3.6.1</b> Interpretation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="anwendung.html"><a href="anwendung.html"><i class="fa fa-check"></i><b>4</b> Anwendung</a><ul>
<li class="chapter" data-level="4.1" data-path="overdisp-diag.html"><a href="overdisp-diag.html"><i class="fa fa-check"></i><b>4.1</b> Overdispersion: Erkennung und Handhabung</a><ul>
<li class="chapter" data-level="4.1.1" data-path="overdisp-diag.html"><a href="overdisp-diag.html#lagrange-mulitplier-test"><i class="fa fa-check"></i><b>4.1.1</b> Lagrange Mulitplier Test</a></li>
<li class="chapter" data-level="4.1.2" data-path="overdisp-diag.html"><a href="overdisp-diag.html#boundary-likelihood-ratio-test-blr"><i class="fa fa-check"></i><b>4.1.2</b> (Boundary) Likelihood Ratio Test (BLR)</a></li>
<li class="chapter" data-level="4.1.3" data-path="overdisp-diag.html"><a href="overdisp-diag.html#umgang-mit-overdispersion"><i class="fa fa-check"></i><b>4.1.3</b> Umgang mit Overdispersion</a><ul>
<li class="chapter" data-level="4.1.3.1" data-path="overdisp-diag.html"><a href="overdisp-diag.html#sandwich"><i class="fa fa-check"></i><b>4.1.3.1</b> Robuste Varianzschätzer (Sandwich Estimators)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="zeros.html"><a href="zeros.html"><i class="fa fa-check"></i><b>4.2</b> Zero-Inflation (ZI)</a><ul>
<li class="chapter" data-level="4.2.1" data-path="zeros.html"><a href="zeros.html#zi-compare"><i class="fa fa-check"></i><b>4.2.1</b> Vergleich von Zero-Inflated models</a></li>
<li class="chapter" data-level="4.2.2" data-path="zeros.html"><a href="zeros.html#zi-modelling"><i class="fa fa-check"></i><b>4.2.2</b> Modellierung</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="entscheidungshilfen.html"><a href="entscheidungshilfen.html"><i class="fa fa-check"></i><b>5</b> Entscheidungshilfen</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="verfugbarkeit.html"><a href="verfugbarkeit.html"><i class="fa fa-check"></i><b>A</b> Verfügbarkeit</a></li>
<li class="chapter" data-level="B" data-path="erganzungen.html"><a href="erganzungen.html"><i class="fa fa-check"></i><b>B</b> Ergänzungen</a><ul>
<li class="chapter" data-level="B.1" data-path="appendix-missingness.html"><a href="appendix-missingness.html"><i class="fa fa-check"></i><b>B.1</b> Missing values und missingness patterns</a></li>
<li class="chapter" data-level="B.2" data-path="trunc-cens.html"><a href="trunc-cens.html"><i class="fa fa-check"></i><b>B.2</b> Truncation und Censoring</a></li>
<li class="chapter" data-level="B.3" data-path="mod-hurdle.html"><a href="mod-hurdle.html"><i class="fa fa-check"></i><b>B.3</b> Hurdle models</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="repro.html"><a href="repro.html"><i class="fa fa-check"></i><b>C</b> Reproduzierbarkeit</a><ul>
<li class="chapter" data-level="C.1" data-path="r-code.html"><a href="r-code.html"><i class="fa fa-check"></i><b>C.1</b> R-Code</a></li>
<li class="chapter" data-level="C.2" data-path="session-info.html"><a href="session-info.html"><i class="fa fa-check"></i><b>C.2</b> Session Info</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="unsorted.html"><a href="unsorted.html"><i class="fa fa-check"></i><b>D</b> Unsorted</a><ul>
<li class="chapter" data-level="D.0.1" data-path="unsorted.html"><a href="unsorted.html#general-advice"><i class="fa fa-check"></i><b>D.0.1</b> General Advice</a></li>
<li class="chapter" data-level="D.0.2" data-path="unsorted.html"><a href="unsorted.html#beispiel-nach-hilbe-2014-p.211ff"><i class="fa fa-check"></i><b>D.0.2</b> Beispiel nach Hilbe (2014 p. 211ff)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="literatur.html"><a href="literatur.html"><i class="fa fa-check"></i>Literatur</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Built with bookdown</a></li>
<li><a href="https://git.tadaa-data.de/lukas/poisson-regression" target="blank">Source on Gitea</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Poisson-Regression und ihre Leiden</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="overdisp-diag" class="section level2">
<h2><span class="header-section-number">4.1</span> Overdispersion: Erkennung und Handhabung</h2>
<p>Es gibt mehrere Möglichkeiten Poisson-overdispersion zu erkennen, wobei die Pearson-Dispersionsstatistik in der Regel der erste Schritt ist.<br />
Im Folgenden werden zusätzlich einige formale Tests aufgeführt.</p>
<div id="lagrange-mulitplier-test" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Lagrange Mulitplier Test</h3>

<div class="definition">
<p><span id="def:unnamed-chunk-3" class="definition"><strong>Definition 4.1  (Lagrange Multiplier Test)  </strong></span>Nach <span class="citation">Hilbe (<a href="#ref-hilbeModelingCountData2014">2014</a>)</span> (p. 85f):</p>
<p>Eine <span class="math inline">\(\chi^2\)</span>-Teststatistik mit einem Freiheitsgrad.</p>
</div>

<p>Eine rudimentäre R-Implementation findet sich in Abschnitt <a href="software-funs.html#helperfuns">1.2.2</a>.</p>
</div>
<div id="boundary-likelihood-ratio-test-blr" class="section level3">
<h3><span class="header-section-number">4.1.2</span> (Boundary) Likelihood Ratio Test (BLR)</h3>
<p>Zum vergleich von zwei geschachtelten (<em>nested</em>) Modellen kann der <em>Likelihood Ratio Test</em> verwendet werden:</p>

<div class="definition">
<p><span id="def:LRT" class="definition"><strong>Definition 4.2  (Likelihood Ratio Test)  </strong></span><span class="math display">\[\begin{equation}
 LR = -2 (\mathcal{L}_R - \mathcal{L}_F)
\end{equation}\]</span></p>
Mit <span class="math inline">\(\mathcal{L}_F\)</span> als log-likelihood des vollen (oder “größeren”) Modells, und <span class="math inline">\(\mathcal{L}_R\)</span> als log-likelihood des reduzierteren Modells.
</div>

<p>Eine Variante des Tests kann verwendet werden, um den Dispersionsparameter <span class="math inline">\(\alpha\)</span> eines NB-Modells zu testen. Da eine NB-Verteilung für <span class="math inline">\(\alpha = 0\)</span> äquivalent zur Poisson ist (siehe Abschnitt <a href="mod-nb.html#mod-nb">3.1</a>), kann ein Poisson-Modell als reduzierte Variante eines NB-Modells betrachtet werden. In diesem Fall verwendet man den <em>Boundary Likelhihood Ratio</em> test:</p>

<div class="definition">
<span id="def:BLR" class="definition"><strong>Definition 4.3  (Boundary Likelihood Ratio Test)  </strong></span><span class="math display">\[\begin{equation}
 BLR = -2 (\mathcal{L}_\mathrm{Poisson} - \mathcal{L}_\mathrm{NB})
\end{equation}\]</span>
</div>

<blockquote>
<p>It is important, though, to remember that the BLR test has a lower limiting case for the value of <span class="math inline">\(\alpha\)</span>, which is what is being tested. Given that the standard parameterization of the negative binomial variance function is <span class="math inline">\(\mu + \alpha \mu^2\)</span> , when <span class="math inline">\(\alpha = 0\)</span>, the variance reduces to <span class="math inline">\(\mu\)</span>.</p>
<p>— <span class="citation">Hilbe (<a href="#ref-hilbeModelingCountData2014">2014</a>)</span>, p. 115</p>
</blockquote>
<p>Der resultierende Wert ist <span class="math inline">\(\chi^2_{(1)}\)</span>-verteilt. Der resultierende p-Wert muss zusätzlich halbiert werden <span class="citation">(siehe Hilbe <a href="#ref-hilbeModelingCountData2014">2014</a>, p. 115)</span>.</p>
<blockquote>
<p>Since the distribution being tested can go no lower than 0, that is the boundary. Only one half of the full distribution is used. Therefore the Chi2 (sic!) test is divided by 2</p>
<p>— <span class="citation">Hilbe (<a href="#ref-hilbeModelingCountData2014">2014</a>)</span>, p. 115</p>
</blockquote>
<p>Am Beispiel der <code>rwm1984</code>-Daten:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="co"># Poisson-Modell</span></a>
<a class="sourceLine" id="cb37-2" data-line-number="2">mod_p &lt;-<span class="st"> </span><span class="kw">glm</span>(docvis <span class="op">~</span><span class="st"> </span>outwork <span class="op">+</span><span class="st"> </span>age, <span class="dt">family =</span> <span class="kw">poisson</span>(), <span class="dt">data =</span> rwm1984)</a>
<a class="sourceLine" id="cb37-3" data-line-number="3"></a>
<a class="sourceLine" id="cb37-4" data-line-number="4"><span class="co"># NB-Modell</span></a>
<a class="sourceLine" id="cb37-5" data-line-number="5">mod_nb &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw">glm.nb</span>(docvis <span class="op">~</span><span class="st"> </span>outwork <span class="op">+</span><span class="st"> </span>age, <span class="dt">data =</span> rwm1984)</a>
<a class="sourceLine" id="cb37-6" data-line-number="6"></a>
<a class="sourceLine" id="cb37-7" data-line-number="7"><span class="co"># BLR: Recht eindeutig.</span></a>
<a class="sourceLine" id="cb37-8" data-line-number="8">lmtest<span class="op">::</span><span class="kw">lrtest</span>(mod_p, mod_nb)</a></code></pre></div>
<div class="kable-table">

<table>
<thead>
<tr>
<th style="text-align:right;">
#Df
</th>
<th style="text-align:right;">
LogLik
</th>
<th style="text-align:right;">
Df
</th>
<th style="text-align:right;">
Chisq
</th>
<th style="text-align:right;">
Pr(&gt;Chisq)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
-15636.390
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
-8332.762
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
14607.26
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="co"># Bei gegebenem BLR-Wert von 4.2 ließe sich der p-Wert wie folgt berechnen:</span></a>
<a class="sourceLine" id="cb38-2" data-line-number="2"><span class="kw">pchisq</span>(<span class="fl">4.2</span>, <span class="dt">df =</span> <span class="dv">1</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">2</span></a></code></pre></div>
<pre><code>#&gt; [1] 0.02021199</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="co"># Oder</span></a>
<a class="sourceLine" id="cb40-2" data-line-number="2">(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pchisq</span>(<span class="fl">4.2</span>, <span class="dt">df =</span> <span class="dv">1</span>)) <span class="op">/</span><span class="st"> </span><span class="dv">2</span></a></code></pre></div>
<pre><code>#&gt; [1] 0.02021199</code></pre>
</div>
<div id="umgang-mit-overdispersion" class="section level3">
<h3><span class="header-section-number">4.1.3</span> Umgang mit Overdispersion</h3>
<p>Zur expliziten Modellierung des Dispersionparameters kann ein NBH Modell (<a href="diagnostische-modelle.html#mod-nbh">3.5.1</a>) genutzt werden, falls die Quelle der overdispersion von besonderem Interesse ist.</p>
<p>Abseits davon bleiben 2 grobe Strategien :</p>
<ol style="list-style-type: decimal">
<li>Adjustierung der durch die overdispersion verzerrten Standardfehler (Quasipoisson, Quasi-Likelihood, robuste Varianzschätzer)</li>
<li>Wechsel auf ein Modell, das overdispersion (oder allgemeine extradispersion) erlaubt (e.g. NB)</li>
</ol>
<p>(Bemerke: Standardfehler für IRRs werden i.A. über die <em>delta method</em> bestimmt, die ich noch recherchieren und irgendwo einbauen muss)</p>
<div id="quasipoisson-skalierung-der-standardfehler" class="section level5 unnumbered">
<h5>Quasipoisson: Skalierung der Standardfehler</h5>
<p>Hier werden lediglich die Standardfehler der Koeffizienten eines Poisson-Modells adjustiert, die bei overdispersion i.d.R. unterschätzt werden – die eigentliche Parameterschätzung wird nicht beeinflusst:</p>
<p><span class="math display">\[\mathrm{SE}(\beta_k) \cdot \sqrt{D}\]</span>
Wobei <span class="math inline">\(D\)</span> der Pearson-Dispersionsindex ist (vgl. <span class="citation">Hilbe (<a href="#ref-hilbeModelingCountData2014">2014</a>)</span>, p. 92ff), den wir in <a href="dispersion.html#def:def-pearsondisp">2.5</a> als <span class="math inline">\(\frac{\chi^2_{\mathrm{Pearson}}}{\mathrm{df}}\)</span> definiert hatten.</p>
<p>Ein möglicher Nachteil jedoch: Es wird zuerst ein reguläres Poisson-Modell gefittet, Standardfehler und Dispersionsindex bestimmt, und dann dasselbe Modell mit skalierten Standardfehlern erneut gefittet – dementsprechend ist diese Methode vermutlich für größere Datensätze eher ineffizient.</p>
<p>Einmal auf unser voriges Beispiel anhand der <code>rwm5yr</code>-Daten angewandt:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="co"># Urprüngliches Model</span></a>
<a class="sourceLine" id="cb42-2" data-line-number="2">mod &lt;-<span class="st"> </span><span class="kw">glm</span>(docvis <span class="op">~</span><span class="st"> </span>outwork <span class="op">+</span><span class="st"> </span>age, <span class="dt">family =</span> <span class="kw">poisson</span>(), <span class="dt">data =</span> rwm1984)</a>
<a class="sourceLine" id="cb42-3" data-line-number="3"></a>
<a class="sourceLine" id="cb42-4" data-line-number="4">mod_qp &lt;-<span class="st"> </span><span class="kw">glm</span>(docvis <span class="op">~</span><span class="st"> </span>outwork <span class="op">+</span><span class="st"> </span>age, <span class="dt">family =</span> <span class="kw">quasipoisson</span>(), <span class="dt">data =</span> rwm1984)</a>
<a class="sourceLine" id="cb42-5" data-line-number="5"></a>
<a class="sourceLine" id="cb42-6" data-line-number="6"><span class="kw">dispersion</span>(mod)</a></code></pre></div>
<pre><code>#&gt; X-squared(3871) = 43909.62
#&gt; Pearson Dispersion = 11.343</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1"><span class="kw">dispersion</span>(mod_qp)</a></code></pre></div>
<pre><code>#&gt; X-squared(3871) = 43909.62
#&gt; Pearson Dispersion = 11.343</code></pre>
<p>An der Dispersion hat sich nichts geändert, nur an den Standardfehlern der Koeffizienten (in folgenden Tabellen auf log-Skala):</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="kw">pander</span>(mod, <span class="dt">caption =</span> <span class="st">&quot;Poisson-Modell&quot;</span>)</a></code></pre></div>
<table style="width:90%;">
<caption>Poisson-Modell</caption>
<colgroup>
<col width="25%" />
<col width="15%" />
<col width="18%" />
<col width="13%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Estimate</th>
<th align="center">Std. Error</th>
<th align="center">z value</th>
<th align="center">Pr(&gt;|z|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>(Intercept)</strong></td>
<td align="center">-0.03352</td>
<td align="center">0.03918</td>
<td align="center">-0.8554</td>
<td align="center">0.3923</td>
</tr>
<tr class="even">
<td align="center"><strong>outwork</strong></td>
<td align="center">0.4079</td>
<td align="center">0.01884</td>
<td align="center">21.65</td>
<td align="center">6.481e-104</td>
</tr>
<tr class="odd">
<td align="center"><strong>age</strong></td>
<td align="center">0.02208</td>
<td align="center">0.0008377</td>
<td align="center">26.36</td>
<td align="center">3.73e-153</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1"><span class="kw">pander</span>(mod_qp, <span class="dt">caption =</span> <span class="st">&quot;Quasipoisson-Modell&quot;</span>)</a></code></pre></div>
<table style="width:89%;">
<caption>Quasipoisson-Modell</caption>
<colgroup>
<col width="25%" />
<col width="15%" />
<col width="18%" />
<col width="13%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Estimate</th>
<th align="center">Std. Error</th>
<th align="center">t value</th>
<th align="center">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>(Intercept)</strong></td>
<td align="center">-0.03352</td>
<td align="center">0.132</td>
<td align="center">-0.254</td>
<td align="center">0.7995</td>
</tr>
<tr class="even">
<td align="center"><strong>outwork</strong></td>
<td align="center">0.4079</td>
<td align="center">0.06347</td>
<td align="center">6.427</td>
<td align="center">1.457e-10</td>
</tr>
<tr class="odd">
<td align="center"><strong>age</strong></td>
<td align="center">0.02208</td>
<td align="center">0.002821</td>
<td align="center">7.827</td>
<td align="center">6.386e-15</td>
</tr>
</tbody>
</table>
<p>In diesem Fall “lohnt” sich dieser Ansatz zwar eher nicht, da wir neben overdispersion noch ein Problem mit zero-inflation haben, aber in manchen Fällen kann Quasipoisson-Methode ausreichen.</p>
<blockquote>
<p>“Scaling is an easy, quick-and-dirty method of adjusting standard errors for overdispersion. However, when data are highly correlated or clustered, model slopes or coefficients usually need to be adjusted as well. Scaling does not accommodate that need, but simulations demonstrate that it is quite useful for models with little to moderate overdispersion.”</p>
<p>— <span class="citation">Hilbe (<a href="#ref-hilbeModelingCountData2014">2014</a>)</span> (p. 96)</p>
</blockquote>
</div>
<div id="sandwich" class="section level4">
<h4><span class="header-section-number">4.1.3.1</span> Robuste Varianzschätzer (Sandwich Estimators)</h4>
<p>(Andere Namen: Huber &amp; White standard errors, empirical standard errors)</p>
<p>Sandwich estimators sind in erster Linie für nicht unabhängige bzw. korrellierte Daten gedacht, zum Beispiel für Daten, die innerhalb mehrere Haushalte, Krankenhäuser, Städte etc. gesammelt wurden.</p>
<p>Robuste Varianzschätzer können (und je nach Quelle: <em>sollten</em>) standardmäßig für Count-response Daten verwendet werden, da die resultierenden Schätzer im Falle tatsächlich unkorrellierter Daten äquivalent zu den Standardfehlern des ursprünglichen Modells sind (i.e. “schadet nicht”).</p>
<p>Bootstrapped SEs wiederum erfordern mehr Aufwand, ähneln aber den robusten SEs sowieso sehr stark, weshalb sich der Aufwand ggf. nicht wirklich lohnt.</p>
<p>Siehe <span class="citation">Hilbe (<a href="#ref-hilbeModelingCountData2014">2014</a>)</span> (p. 99f) für eine ausführlichere Beschreibung. Zudem gibt der Autor explizit den Rat:</p>
<blockquote>
<p>“Unless your Poisson or negative binomial model is well fitted and meets its respective distributional assumptions, use robust or empirical standard errors as a default”</p>
<p>— <span class="citation">Hilbe (<a href="#ref-hilbeModelingCountData2014">2014</a>)</span> (p. 133)</p>
</blockquote>
</div>
</div>
</div>
<h3>Literatur</h3>
<div id="refs" class="references">
<div id="ref-hilbeModelingCountData2014">
<p>Hilbe, Joseph M. 2014. <em>Modeling Count Data</em>. Cambridge: Cambridge University Press. <a href="https://doi.org/10.1017/CBO9781139236065" class="uri">https://doi.org/10.1017/CBO9781139236065</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="anwendung.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="zeros.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["poisson-regression.pdf", "poisson-regression.tex", "poisson-regression.epub"],
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
