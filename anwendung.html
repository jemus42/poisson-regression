<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de-DE" xml:lang="de-DE">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Kapitel 4 Anwendung | Poisson-Regression und ihre Leiden</title>
  <meta name="description" content="Because count data is hard" />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="Kapitel 4 Anwendung | Poisson-Regression und ihre Leiden" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="includes/images/poiscovr-orly.png" />
  <meta property="og:description" content="Because count data is hard" />
  <meta name="github-repo" content="jemus42/poisson-regression" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Kapitel 4 Anwendung | Poisson-Regression und ihre Leiden" />
  
  <meta name="twitter:description" content="Because count data is hard" />
  <meta name="twitter:image" content="includes/images/poiscovr-orly.png" />

<meta name="author" content="Lukas Burk" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="mod-zi.html"/>
<link rel="next" href="overdisp-diag.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/viz-0.3/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.1/grViz.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { fonts: ["Asana-Math"] },
    MathMenu: { showFontMenu: true },
    menuSettings: { zoom: "Click" }
  });
</script>
<link href="https://fonts.googleapis.com/css?family=Roboto|Roboto+Condensed|Roboto+Slab&display=swap" rel="stylesheet">


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="includes/css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Poisson Regression</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Einführung</a><ul>
<li class="chapter" data-level="1.1" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>1.1</b> Beispieldaten</a></li>
<li class="chapter" data-level="1.2" data-path="software-funs.html"><a href="software-funs.html"><i class="fa fa-check"></i><b>1.2</b> Verwendete Software</a><ul>
<li class="chapter" data-level="1.2.1" data-path="software-funs.html"><a href="software-funs.html#r-packages"><i class="fa fa-check"></i><b>1.2.1</b> R-Packages</a></li>
<li class="chapter" data-level="1.2.2" data-path="software-funs.html"><a href="software-funs.html#helperfuns"><i class="fa fa-check"></i><b>1.2.2</b> Funktionen</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="poisson-modell.html"><a href="poisson-modell.html"><i class="fa fa-check"></i><b>2</b> Das Poisson-Modell</a><ul>
<li class="chapter" data-level="2.1" data-path="annahmen.html"><a href="annahmen.html"><i class="fa fa-check"></i><b>2.1</b> Annahmen</a></li>
<li class="chapter" data-level="2.2" data-path="dispersion.html"><a href="dispersion.html"><i class="fa fa-check"></i><b>2.2</b> Dispersion</a><ul>
<li class="chapter" data-level="2.2.1" data-path="dispersion.html"><a href="dispersion.html#overdispersion"><i class="fa fa-check"></i><b>2.2.1</b> Overdispersion</a></li>
<li class="chapter" data-level="2.2.2" data-path="dispersion.html"><a href="dispersion.html#underdispersion"><i class="fa fa-check"></i><b>2.2.2</b> Underdispersion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="multiparam.html"><a href="multiparam.html"><i class="fa fa-check"></i><b>3</b> Mehrparametrische Modelle</a><ul>
<li class="chapter" data-level="3.1" data-path="mod-nb.html"><a href="mod-nb.html"><i class="fa fa-check"></i><b>3.1</b> Negativ Binomial (NB)</a></li>
<li class="chapter" data-level="3.2" data-path="mod-pig.html"><a href="mod-pig.html"><i class="fa fa-check"></i><b>3.2</b> Poisson Inverse Gaussian (PIG)</a></li>
<li class="chapter" data-level="3.3" data-path="mod-gp.html"><a href="mod-gp.html"><i class="fa fa-check"></i><b>3.3</b> Generalized Poisson (GP)</a></li>
<li class="chapter" data-level="3.4" data-path="mod-comp.html"><a href="mod-comp.html"><i class="fa fa-check"></i><b>3.4</b> Conway-Maxwell Poisson (COMP)</a></li>
<li class="chapter" data-level="3.5" data-path="diagnostische-modelle.html"><a href="diagnostische-modelle.html"><i class="fa fa-check"></i><b>3.5</b> Diagnostische Modelle</a><ul>
<li class="chapter" data-level="3.5.1" data-path="diagnostische-modelle.html"><a href="diagnostische-modelle.html#mod-nbh"><i class="fa fa-check"></i><b>3.5.1</b> Heterogenous Negative Binomial (NBH)</a></li>
<li class="chapter" data-level="3.5.2" data-path="diagnostische-modelle.html"><a href="diagnostische-modelle.html#mod-nbp"><i class="fa fa-check"></i><b>3.5.2</b> Negative binomial-P (NB-P)</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="mod-zi.html"><a href="mod-zi.html"><i class="fa fa-check"></i><b>3.6</b> Zero-Inflated Models (<em>mixture models</em>)</a><ul>
<li class="chapter" data-level="3.6.1" data-path="mod-zi.html"><a href="mod-zi.html#interpretation"><i class="fa fa-check"></i><b>3.6.1</b> Interpretation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="anwendung.html"><a href="anwendung.html"><i class="fa fa-check"></i><b>4</b> Anwendung</a><ul>
<li class="chapter" data-level="4.1" data-path="overdisp-diag.html"><a href="overdisp-diag.html"><i class="fa fa-check"></i><b>4.1</b> Overdispersion: Erkennung und Handhabung</a><ul>
<li class="chapter" data-level="4.1.1" data-path="overdisp-diag.html"><a href="overdisp-diag.html#lagrange-mulitplier-test"><i class="fa fa-check"></i><b>4.1.1</b> Lagrange Mulitplier Test</a></li>
<li class="chapter" data-level="4.1.2" data-path="overdisp-diag.html"><a href="overdisp-diag.html#boundary-likelihood-ratio-test-blr"><i class="fa fa-check"></i><b>4.1.2</b> (Boundary) Likelihood Ratio Test (BLR)</a></li>
<li class="chapter" data-level="4.1.3" data-path="overdisp-diag.html"><a href="overdisp-diag.html#umgang-mit-overdispersion"><i class="fa fa-check"></i><b>4.1.3</b> Umgang mit Overdispersion</a><ul>
<li class="chapter" data-level="4.1.3.1" data-path="overdisp-diag.html"><a href="overdisp-diag.html#sandwich"><i class="fa fa-check"></i><b>4.1.3.1</b> Robuste Varianzschätzer (Sandwich Estimators)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="zeros.html"><a href="zeros.html"><i class="fa fa-check"></i><b>4.2</b> Zero-Inflation (ZI)</a><ul>
<li class="chapter" data-level="4.2.1" data-path="zeros.html"><a href="zeros.html#zi-compare"><i class="fa fa-check"></i><b>4.2.1</b> Vergleich von Zero-Inflated models</a></li>
<li class="chapter" data-level="4.2.2" data-path="zeros.html"><a href="zeros.html#zi-modelling"><i class="fa fa-check"></i><b>4.2.2</b> Modellierung</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="entscheidungshilfen.html"><a href="entscheidungshilfen.html"><i class="fa fa-check"></i><b>5</b> Entscheidungshilfen</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="verfügbarkeit.html"><a href="verfügbarkeit.html"><i class="fa fa-check"></i><b>A</b> Verfügbarkeit</a></li>
<li class="chapter" data-level="B" data-path="ergänzungen.html"><a href="ergänzungen.html"><i class="fa fa-check"></i><b>B</b> Ergänzungen</a><ul>
<li class="chapter" data-level="B.1" data-path="appendix-missingness.html"><a href="appendix-missingness.html"><i class="fa fa-check"></i><b>B.1</b> Missing values und missingness patterns</a></li>
<li class="chapter" data-level="B.2" data-path="trunc-cens.html"><a href="trunc-cens.html"><i class="fa fa-check"></i><b>B.2</b> Truncation und Censoring</a></li>
<li class="chapter" data-level="B.3" data-path="mod-hurdle.html"><a href="mod-hurdle.html"><i class="fa fa-check"></i><b>B.3</b> Hurdle models</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="repro.html"><a href="repro.html"><i class="fa fa-check"></i><b>C</b> Reproduzierbarkeit</a><ul>
<li class="chapter" data-level="C.1" data-path="r-code.html"><a href="r-code.html"><i class="fa fa-check"></i><b>C.1</b> R-Code</a></li>
<li class="chapter" data-level="C.2" data-path="session-info.html"><a href="session-info.html"><i class="fa fa-check"></i><b>C.2</b> Session Info</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="unsorted.html"><a href="unsorted.html"><i class="fa fa-check"></i><b>D</b> Unsorted</a><ul>
<li class="chapter" data-level="D.1" data-path="general-advice.html"><a href="general-advice.html"><i class="fa fa-check"></i><b>D.1</b> General Advice</a></li>
<li class="chapter" data-level="D.2" data-path="beispiel-nach-hilbe-2014-p-211ff.html"><a href="beispiel-nach-hilbe-2014-p-211ff.html"><i class="fa fa-check"></i><b>D.2</b> Beispiel nach Hilbe (2014 p. 211ff)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="literatur.html"><a href="literatur.html"><i class="fa fa-check"></i>Literatur</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Built with bookdown</a></li>
<li><a href="https://git.tadaa-data.de/lukas/poisson-regression" target="blank">Source on Gitea</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Poisson-Regression und ihre Leiden</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="anwendung" class="section level1">
<h1><span class="header-section-number">Kapitel 4</span> Anwendung</h1>
<p>Als Beispiel verwenden wir hier <code>rwm1984</code>, ein Subset des Datensatz <code>rwm5yr</code> (vgl. Abschnitt <a href="data.html#data">1.1</a>, <code>?COUNT::rwm1984</code>), der Angaben zur Anzahl der Arztbesuche pro Person mit zusätzlichen demographischen Merkmalen enthält. Für unser Beispielmodell verwenden wir folgende Variablen:</p>
<ul>
<li><code>docvis</code>: Abhängige Variable, Anzahl der Arztbesuche im Jahr (0-121)</li>
<li><code>outwork</code>: Arbeitslos (1), arbeitend (0)</li>
<li><code>age</code>: Alter (25 - 64)</li>
</ul>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="anwendung.html#cb33-1"></a><span class="co"># Daten</span></span>
<span id="cb33-2"><a href="anwendung.html#cb33-2"></a><span class="kw">data</span>(rwm1984, <span class="dt">package =</span> <span class="st">&quot;COUNT&quot;</span>)</span>
<span id="cb33-3"><a href="anwendung.html#cb33-3"></a></span>
<span id="cb33-4"><a href="anwendung.html#cb33-4"></a><span class="co"># Model fit</span></span>
<span id="cb33-5"><a href="anwendung.html#cb33-5"></a>mod_rwm &lt;-<span class="st"> </span><span class="kw">glm</span>(docvis <span class="op">~</span><span class="st"> </span>outwork <span class="op">+</span><span class="st"> </span>age, <span class="dt">family =</span> <span class="kw">poisson</span>(), <span class="dt">data =</span> rwm1984)</span>
<span id="cb33-6"><a href="anwendung.html#cb33-6"></a></span>
<span id="cb33-7"><a href="anwendung.html#cb33-7"></a><span class="co"># Summary display</span></span>
<span id="cb33-8"><a href="anwendung.html#cb33-8"></a><span class="kw">pander</span>(<span class="kw">summary</span>(mod_rwm))</span></code></pre></div>
<table style="width:90%;">
<colgroup>
<col width="25%" />
<col width="15%" />
<col width="18%" />
<col width="13%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Estimate</th>
<th align="center">Std. Error</th>
<th align="center">z value</th>
<th align="center">Pr(&gt;|z|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>(Intercept)</strong></td>
<td align="center">-0.03352</td>
<td align="center">0.03918</td>
<td align="center">-0.8554</td>
<td align="center">0.3923</td>
</tr>
<tr class="even">
<td align="center"><strong>outwork</strong></td>
<td align="center">0.4079</td>
<td align="center">0.01884</td>
<td align="center">21.65</td>
<td align="center">6.481e-104</td>
</tr>
<tr class="odd">
<td align="center"><strong>age</strong></td>
<td align="center">0.02208</td>
<td align="center">0.0008377</td>
<td align="center">26.36</td>
<td align="center">3.73e-153</td>
</tr>
</tbody>
</table>
<p>(Dispersion parameter for poisson family taken to be 1 )</p>
<table style="width:69%;">
<colgroup>
<col width="29%" />
<col width="40%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="center">Null deviance:</td>
<td align="center">25791 on 3873 degrees of
freedom</td>
</tr>
<tr class="even">
<td align="center">Residual deviance:</td>
<td align="center">24190 on 3871 degrees of
freedom</td>
</tr>
</tbody>
</table>
<p>Das erste was wir zur Evaluation unseres Modells tun können, ohne direkt andere Modelle zum vergleich heranzuziehen, ist die beobachteten Counts und die auf Basis des Modells erwarteten Counts zu vergleichen, um ein grobes Gefühl für die Situation zu erhalten (Code frei adaptiert nach <span class="citation">Hilbe (<a href="#ref-hilbeModelingCountData2014" role="doc-biblioref">2014</a>)</span>, p. 88f):</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="anwendung.html#cb34-1"></a><span class="co"># Beobachtete und erwartete counts</span></span>
<span id="cb34-2"><a href="anwendung.html#cb34-2"></a>observed_v_expected &lt;-<span class="st"> </span>rwm1984 <span class="op">%&gt;%</span></span>
<span id="cb34-3"><a href="anwendung.html#cb34-3"></a><span class="st">  </span><span class="kw">count</span>(docvis, <span class="dt">name =</span> <span class="st">&quot;observed&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb34-4"><a href="anwendung.html#cb34-4"></a><span class="st">  </span><span class="kw">mutate</span>(</span>
<span id="cb34-5"><a href="anwendung.html#cb34-5"></a>    <span class="dt">expected =</span> purrr<span class="op">::</span><span class="kw">map_dbl</span>(docvis, <span class="op">~</span>{</span>
<span id="cb34-6"><a href="anwendung.html#cb34-6"></a>                  <span class="kw">dpois</span>(.x, <span class="kw">fitted</span>(mod_rwm)) <span class="op">%&gt;%</span></span>
<span id="cb34-7"><a href="anwendung.html#cb34-7"></a><span class="st">                    </span><span class="kw">sum</span>() <span class="op">%&gt;%</span></span>
<span id="cb34-8"><a href="anwendung.html#cb34-8"></a><span class="st">                    </span><span class="kw">round</span>(<span class="dv">2</span>)</span>
<span id="cb34-9"><a href="anwendung.html#cb34-9"></a>                }),</span>
<span id="cb34-10"><a href="anwendung.html#cb34-10"></a>    <span class="dt">difference =</span> observed <span class="op">-</span><span class="st"> </span>expected</span>
<span id="cb34-11"><a href="anwendung.html#cb34-11"></a>  ) </span>
<span id="cb34-12"><a href="anwendung.html#cb34-12"></a></span>
<span id="cb34-13"><a href="anwendung.html#cb34-13"></a>observed_v_expected <span class="op">%&gt;%</span></span>
<span id="cb34-14"><a href="anwendung.html#cb34-14"></a><span class="st">  </span><span class="kw">head</span>(<span class="dv">5</span>) <span class="op">%&gt;%</span></span>
<span id="cb34-15"><a href="anwendung.html#cb34-15"></a><span class="st">  </span><span class="kw">pander</span>(<span class="dt">caption =</span> <span class="st">&quot;Observed and expected counts&quot;</span>)</span></code></pre></div>
<table style="width:61%;">
<caption>Observed and expected counts</caption>
<colgroup>
<col width="12%" />
<col width="15%" />
<col width="15%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">docvis</th>
<th align="center">observed</th>
<th align="center">expected</th>
<th align="center">difference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="center">1611</td>
<td align="center">264.8</td>
<td align="center">1346</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">448</td>
<td align="center">627.1</td>
<td align="center">-179.1</td>
</tr>
<tr class="odd">
<td align="center">2</td>
<td align="center">440</td>
<td align="center">796</td>
<td align="center">-356</td>
</tr>
<tr class="even">
<td align="center">3</td>
<td align="center">353</td>
<td align="center">731.6</td>
<td align="center">-378.6</td>
</tr>
<tr class="odd">
<td align="center">4</td>
<td align="center">213</td>
<td align="center">554.6</td>
<td align="center">-341.6</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="anwendung.html#cb35-1"></a><span class="co"># Mittelwert und Varianz der jeweiligen counts</span></span>
<span id="cb35-2"><a href="anwendung.html#cb35-2"></a><span class="co"># (für &quot;expected&quot; gilt Varianz := Mittelwert)</span></span>
<span id="cb35-3"><a href="anwendung.html#cb35-3"></a><span class="kw">tribble</span>(</span>
<span id="cb35-4"><a href="anwendung.html#cb35-4"></a>  <span class="op">~</span>Counts,   <span class="op">~</span>Mean,                 <span class="op">~</span>Variance,</span>
<span id="cb35-5"><a href="anwendung.html#cb35-5"></a>  <span class="st">&quot;observed&quot;</span>, <span class="kw">mean</span>(rwm1984<span class="op">$</span>docvis), <span class="kw">var</span>(rwm1984<span class="op">$</span>docvis),</span>
<span id="cb35-6"><a href="anwendung.html#cb35-6"></a>  <span class="st">&quot;expected&quot;</span>, <span class="kw">mean</span>(<span class="kw">fitted</span>(mod)),    <span class="kw">mean</span>(<span class="kw">fitted</span>(mod))</span>
<span id="cb35-7"><a href="anwendung.html#cb35-7"></a>) <span class="op">%&gt;%</span></span>
<span id="cb35-8"><a href="anwendung.html#cb35-8"></a><span class="st">  </span><span class="kw">pander</span>(<span class="dt">caption =</span> <span class="st">&quot;Mean &amp; variance of observed and expected counts&quot;</span>)</span></code></pre></div>
<table style="width:42%;">
<caption>Mean &amp; variance of observed and expected counts</caption>
<colgroup>
<col width="15%" />
<col width="11%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Counts</th>
<th align="center">Mean</th>
<th align="center">Variance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">observed</td>
<td align="center">3.163</td>
<td align="center">39.39</td>
</tr>
<tr class="even">
<td align="center">expected</td>
<td align="center">5.401</td>
<td align="center">5.401</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="anwendung.html#cb36-1"></a><span class="co"># Plot: observed vs. expected counts</span></span>
<span id="cb36-2"><a href="anwendung.html#cb36-2"></a>observed_v_expected <span class="op">%&gt;%</span></span>
<span id="cb36-3"><a href="anwendung.html#cb36-3"></a><span class="st">  </span><span class="kw">filter</span>(docvis <span class="op">&lt;=</span><span class="st"> </span><span class="dv">12</span>) <span class="op">%&gt;%</span></span>
<span id="cb36-4"><a href="anwendung.html#cb36-4"></a><span class="st">  </span><span class="kw">gather</span>(type, count, observed, expected) <span class="op">%&gt;%</span></span>
<span id="cb36-5"><a href="anwendung.html#cb36-5"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> docvis, <span class="dt">y =</span> count, <span class="dt">fill =</span> type, <span class="dt">color =</span> type)) <span class="op">+</span></span>
<span id="cb36-6"><a href="anwendung.html#cb36-6"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">stroke =</span> <span class="fl">.5</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb36-7"><a href="anwendung.html#cb36-7"></a><span class="st">  </span><span class="kw">geom_path</span>(<span class="dt">linetype =</span> <span class="st">&quot;dotted&quot;</span>, <span class="dt">size =</span> <span class="fl">.25</span>) <span class="op">+</span></span>
<span id="cb36-8"><a href="anwendung.html#cb36-8"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">12</span>, <span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb36-9"><a href="anwendung.html#cb36-9"></a><span class="st">  </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Set1&quot;</span>, <span class="dt">aesthetics =</span> <span class="kw">c</span>(<span class="st">&quot;color&quot;</span>, <span class="st">&quot;fill&quot;</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span></span>
<span id="cb36-10"><a href="anwendung.html#cb36-10"></a><span class="st">  </span><span class="kw">labs</span>(</span>
<span id="cb36-11"><a href="anwendung.html#cb36-11"></a>    <span class="dt">title =</span> <span class="st">&quot;rwm1984: Poisson Modell&quot;</span>,</span>
<span id="cb36-12"><a href="anwendung.html#cb36-12"></a>    <span class="dt">subtitle =</span> <span class="st">&quot;Observed und expected counts bei overdispersion&quot;</span>,</span>
<span id="cb36-13"><a href="anwendung.html#cb36-13"></a>    <span class="dt">caption =</span> <span class="st">&quot;Output begrenzt auf docvs &lt;= 12&quot;</span>,</span>
<span id="cb36-14"><a href="anwendung.html#cb36-14"></a>    <span class="dt">x =</span> <span class="st">&quot;Anzahl der Arztbesuche (docvis)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Count&quot;</span></span>
<span id="cb36-15"><a href="anwendung.html#cb36-15"></a>  ) <span class="op">+</span></span>
<span id="cb36-16"><a href="anwendung.html#cb36-16"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span></code></pre></div>
<p><img src="poisson-regression_files/figure-html/diag_compare_expected-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Anhand der ersten Tabelle können wir recht schnell erkennen, dass wir hier <em>deutlich</em> mehr Nullen beobachten als das Modell vorhersagt – mehr dazu in Abschnitt <a href="zeros.html#zeros">4.2</a>.<br />
Der Plot veranschaulicht den eher suboptimalen model fit unter diesen Umständen (overdispersion und (bzw. bedingt durch) zero-inflation).</p> 
</div>
<h3>Literatur</h3>
<div id="refs" class="references">
<div id="ref-hilbeModelingCountData2014">
<p>Hilbe, Joseph M. 2014. <em>Modeling Count Data</em>. Cambridge: Cambridge University Press. <a href="https://doi.org/10.1017/CBO9781139236065">https://doi.org/10.1017/CBO9781139236065</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mod-zi.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="overdisp-diag.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["poisson-regression.pdf", "poisson-regression.tex", "poisson-regression.epub"],
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
