<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de-DE" xml:lang="de-DE">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Kapitel 5 Anwendung | Poisson-Regression und ihre Leiden</title>
  <meta name="description" content="Because count data is hard" />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="Kapitel 5 Anwendung | Poisson-Regression und ihre Leiden" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/poiscovr-orly.png" />
  <meta property="og:description" content="Because count data is hard" />
  <meta name="github-repo" content="jemus42/poisson-regression" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Kapitel 5 Anwendung | Poisson-Regression und ihre Leiden" />
  
  <meta name="twitter:description" content="Because count data is hard" />
  <meta name="twitter:image" content="images/poiscovr-orly.png" />

<meta name="author" content="Lukas Burk" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="weitere-modelle.html"/>
<link rel="next" href="entscheidungshilfen.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="libs/viz-0.3/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.1/grViz.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { fonts: ["Asana-Math"] },
    MathMenu: { showFontMenu: true },
    menuSettings: { zoom: "Click" }
  });
</script>
<link href="https://fonts.googleapis.com/css?family=Roboto|Roboto+Condensed|Roboto+Slab&display=swap" rel="stylesheet">


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Poisson Regression</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Einf√ºhrung</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#data"><i class="fa fa-check"></i><b>1.1</b> Beispieldaten</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#software-funs"><i class="fa fa-check"></i><b>1.2</b> Verwendete Software</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#r-packages"><i class="fa fa-check"></i><b>1.2.1</b> R-Packages</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#helperfuns"><i class="fa fa-check"></i><b>1.2.2</b> Funktionen</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="poisson-modell.html"><a href="poisson-modell.html"><i class="fa fa-check"></i><b>2</b> Das Poisson-Modell</a><ul>
<li class="chapter" data-level="2.1" data-path="poisson-modell.html"><a href="poisson-modell.html#annahmen"><i class="fa fa-check"></i><b>2.1</b> Annahmen</a></li>
<li class="chapter" data-level="2.2" data-path="poisson-modell.html"><a href="poisson-modell.html#dispersion"><i class="fa fa-check"></i><b>2.2</b> Dispersion</a><ul>
<li class="chapter" data-level="2.2.1" data-path="poisson-modell.html"><a href="poisson-modell.html#overdispersion"><i class="fa fa-check"></i><b>2.2.1</b> Overdispersion</a></li>
<li class="chapter" data-level="2.2.2" data-path="poisson-modell.html"><a href="poisson-modell.html#underdispersion"><i class="fa fa-check"></i><b>2.2.2</b> Underdispersion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="multiparam.html"><a href="multiparam.html"><i class="fa fa-check"></i><b>3</b> Mehrparametrische Modelle</a><ul>
<li class="chapter" data-level="3.1" data-path="multiparam.html"><a href="multiparam.html#mod-nb"><i class="fa fa-check"></i><b>3.1</b> Negativ Binomial (NB)</a></li>
<li class="chapter" data-level="3.2" data-path="multiparam.html"><a href="multiparam.html#mod-pig"><i class="fa fa-check"></i><b>3.2</b> Poisson Inverse Gaussian (PIG)</a></li>
<li class="chapter" data-level="3.3" data-path="multiparam.html"><a href="multiparam.html#mod-gp"><i class="fa fa-check"></i><b>3.3</b> Generalized Poisson (GP)</a></li>
<li class="chapter" data-level="3.4" data-path="multiparam.html"><a href="multiparam.html#mod-comp"><i class="fa fa-check"></i><b>3.4</b> Conway-Maxwell Poisson (COMP)</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="weitere-modelle.html"><a href="weitere-modelle.html"><i class="fa fa-check"></i><b>4</b> Weitere Modelle</a><ul>
<li class="chapter" data-level="4.1" data-path="weitere-modelle.html"><a href="weitere-modelle.html#diagnostische-modelle"><i class="fa fa-check"></i><b>4.1</b> Diagnostische Modelle</a><ul>
<li class="chapter" data-level="4.1.1" data-path="weitere-modelle.html"><a href="weitere-modelle.html#mod-nbh"><i class="fa fa-check"></i><b>4.1.1</b> Heterogenous Negative Binomial (NBH)</a></li>
<li class="chapter" data-level="4.1.2" data-path="weitere-modelle.html"><a href="weitere-modelle.html#mod-nbp"><i class="fa fa-check"></i><b>4.1.2</b> Negative binomial-P (NB-P)</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="weitere-modelle.html"><a href="weitere-modelle.html#mod-zi"><i class="fa fa-check"></i><b>4.2</b> Zero-Inflated Models (<em>mixture models</em>)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="anwendung.html"><a href="anwendung.html"><i class="fa fa-check"></i><b>5</b> Anwendung</a><ul>
<li class="chapter" data-level="5.1" data-path="anwendung.html"><a href="anwendung.html#overdisp-diag"><i class="fa fa-check"></i><b>5.1</b> Overdispersion: Erkennung und Handhabung</a><ul>
<li class="chapter" data-level="5.1.1" data-path="anwendung.html"><a href="anwendung.html#boundary-likelihood-ratio-test-blr"><i class="fa fa-check"></i><b>5.1.1</b> (Boundary) Likelihood Ratio Test (BLR)</a></li>
<li class="chapter" data-level="5.1.2" data-path="anwendung.html"><a href="anwendung.html#umgang-mit-overdispersion"><i class="fa fa-check"></i><b>5.1.2</b> Umgang mit Overdispersion</a><ul>
<li class="chapter" data-level="5.1.2.1" data-path="anwendung.html"><a href="anwendung.html#sandwich"><i class="fa fa-check"></i><b>5.1.2.1</b> Robuste Varianzsch√§tzer (Sandwich Estimators)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="anwendung.html"><a href="anwendung.html#zeros"><i class="fa fa-check"></i><b>5.2</b> Zero-Inflation (ZI)</a><ul>
<li class="chapter" data-level="" data-path="anwendung.html"><a href="anwendung.html#vergleich-von-zero-inflated-models"><i class="fa fa-check"></i>Vergleich von Zero-Inflated models</a></li>
<li class="chapter" data-level="" data-path="anwendung.html"><a href="anwendung.html#modellierung"><i class="fa fa-check"></i>Modellierung</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="entscheidungshilfen.html"><a href="entscheidungshilfen.html"><i class="fa fa-check"></i><b>6</b> Entscheidungshilfen</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="verfugbarkeit.html"><a href="verfugbarkeit.html"><i class="fa fa-check"></i><b>A</b> Verf√ºgbarkeit</a></li>
<li class="chapter" data-level="B" data-path="erganzungen.html"><a href="erganzungen.html"><i class="fa fa-check"></i><b>B</b> Erg√§nzungen</a><ul>
<li class="chapter" data-level="B.1" data-path="erganzungen.html"><a href="erganzungen.html#appendix-missingness"><i class="fa fa-check"></i><b>B.1</b> Missing values und missingness patterns</a></li>
<li class="chapter" data-level="B.2" data-path="erganzungen.html"><a href="erganzungen.html#trunc-cens"><i class="fa fa-check"></i><b>B.2</b> Truncation und Censoring</a></li>
<li class="chapter" data-level="B.3" data-path="erganzungen.html"><a href="erganzungen.html#mod-hurdle"><i class="fa fa-check"></i><b>B.3</b> Hurdle models</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="repro.html"><a href="repro.html"><i class="fa fa-check"></i><b>C</b> Reproduzierbarkeit</a><ul>
<li class="chapter" data-level="C.1" data-path="repro.html"><a href="repro.html#r-code"><i class="fa fa-check"></i><b>C.1</b> R-Code</a></li>
<li class="chapter" data-level="C.2" data-path="repro.html"><a href="repro.html#session-info"><i class="fa fa-check"></i><b>C.2</b> Session Info</a></li>
<li class="chapter" data-level="C.3" data-path="repro.html"><a href="repro.html#unsorted"><i class="fa fa-check"></i><b>C.3</b> Unsorted</a><ul>
<li class="chapter" data-level="C.3.1" data-path="repro.html"><a href="repro.html#general-advice"><i class="fa fa-check"></i><b>C.3.1</b> General Advice</a></li>
<li class="chapter" data-level="C.3.2" data-path="repro.html"><a href="repro.html#beispiel-nach-hilbemodelingcountdata2014-p.211ff"><i class="fa fa-check"></i><b>C.3.2</b> Beispiel nach <span class="citation">Hilbe (<a href="#ref-hilbeModelingCountData2014">2014</a>)</span>, p.¬†211ff</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="literatur.html"><a href="literatur.html"><i class="fa fa-check"></i>Literatur</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Built with bookdown</a></li>
<li><a href="https://git.tadaa-data.de/lukas/poisson-regression" target="blank">Source on Gitea</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Poisson-Regression und ihre Leiden</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="anwendung" class="section level1">
<h1><span class="header-section-number">Kapitel 5</span> Anwendung</h1>
<p>Als Beispiel verwenden wir hier <code>rwm1984</code>, ein Subset des Datensatz <code>rwm5yr</code> (vgl. Abschnitt <a href="index.html#data">1.1</a>, <code>?COUNT::rwm1984</code>), der Angaben zur Anzahl der Arztbesuche pro Person mit zus√§tzlichen demographischen Merkmalen enth√§lt. F√ºr unser Beispielmodell verwenden wir folgende Variablen:</p>
<ul>
<li><code>docvis</code>: Abh√§ngige Variable, Anzahl der Arztbesuche im Jahr (0-121)</li>
<li><code>outwork</code>: Arbeitslos (1), arbeitend (0)</li>
<li><code>age</code>: Alter (25 - 64)</li>
</ul>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="co"># Daten</span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="kw">data</span>(rwm1984, <span class="dt">package =</span> <span class="st">&quot;COUNT&quot;</span>)</a>
<a class="sourceLine" id="cb23-3" data-line-number="3"></a>
<a class="sourceLine" id="cb23-4" data-line-number="4"><span class="co"># Model fit</span></a>
<a class="sourceLine" id="cb23-5" data-line-number="5">mod_rwm &lt;-<span class="st"> </span><span class="kw">glm</span>(docvis <span class="op">~</span><span class="st"> </span>outwork <span class="op">+</span><span class="st"> </span>age, <span class="dt">family =</span> <span class="kw">poisson</span>(), <span class="dt">data =</span> rwm1984)</a>
<a class="sourceLine" id="cb23-6" data-line-number="6"></a>
<a class="sourceLine" id="cb23-7" data-line-number="7"><span class="co"># Summary display</span></a>
<a class="sourceLine" id="cb23-8" data-line-number="8"><span class="kw">pander</span>(<span class="kw">summary</span>(mod_rwm))</a></code></pre></div>
<table style="width:90%;">
<colgroup>
<col width="25%" />
<col width="15%" />
<col width="18%" />
<col width="13%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">¬†</th>
<th align="center">Estimate</th>
<th align="center">Std. Error</th>
<th align="center">z value</th>
<th align="center">Pr(&gt;|z|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>(Intercept)</strong></td>
<td align="center">-0.03352</td>
<td align="center">0.03918</td>
<td align="center">-0.8554</td>
<td align="center">0.3923</td>
</tr>
<tr class="even">
<td align="center"><strong>outwork</strong></td>
<td align="center">0.4079</td>
<td align="center">0.01884</td>
<td align="center">21.65</td>
<td align="center">6.481e-104</td>
</tr>
<tr class="odd">
<td align="center"><strong>age</strong></td>
<td align="center">0.02208</td>
<td align="center">0.0008377</td>
<td align="center">26.36</td>
<td align="center">3.73e-153</td>
</tr>
</tbody>
</table>
<p>(Dispersion parameter for poisson family taken to be 1 )</p>
<table style="width:69%;">
<colgroup>
<col width="29%" />
<col width="40%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="center">Null deviance:</td>
<td align="center">25791 on 3873 degrees of
freedom</td>
</tr>
<tr class="even">
<td align="center">Residual deviance:</td>
<td align="center">24190 on 3871 degrees of
freedom</td>
</tr>
</tbody>
</table>
<p>Das erste was wir zur Evaluation unseres Modells tun k√∂nnen, ohne direkt andere Modelle zum vergleich heranzuziehen, ist die beobachteten Counts und die auf Basis des Modells erwarteten Counts zu vergleichen, um ein grobes Gef√ºhl f√ºr die Situation zu erhalten (Code frei adaptiert nach <span class="citation">Hilbe (<a href="#ref-hilbeModelingCountData2014">2014</a>)</span>, p.¬†88f):</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="co"># Beobachtete und erwartete counts</span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2">observed_v_expected &lt;-<span class="st"> </span>rwm1984 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="st">  </span><span class="kw">count</span>(docvis, <span class="dt">name =</span> <span class="st">&quot;observed&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb24-5" data-line-number="5">    <span class="dt">expected =</span> purrr<span class="op">::</span><span class="kw">map_dbl</span>(docvis, <span class="op">~</span>{</a>
<a class="sourceLine" id="cb24-6" data-line-number="6">                  <span class="kw">dpois</span>(.x, <span class="kw">fitted</span>(mod_rwm)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-7" data-line-number="7"><span class="st">                    </span><span class="kw">sum</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-8" data-line-number="8"><span class="st">                    </span><span class="kw">round</span>(<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb24-9" data-line-number="9">                }),</a>
<a class="sourceLine" id="cb24-10" data-line-number="10">    <span class="dt">difference =</span> observed <span class="op">-</span><span class="st"> </span>expected</a>
<a class="sourceLine" id="cb24-11" data-line-number="11">  ) </a>
<a class="sourceLine" id="cb24-12" data-line-number="12"></a>
<a class="sourceLine" id="cb24-13" data-line-number="13">observed_v_expected <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-14" data-line-number="14"><span class="st">  </span><span class="kw">head</span>(<span class="dv">5</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-15" data-line-number="15"><span class="st">  </span><span class="kw">pander</span>(<span class="dt">caption =</span> <span class="st">&quot;Observed and expected counts&quot;</span>)</a></code></pre></div>
<table style="width:61%;">
<caption>Observed and expected counts</caption>
<colgroup>
<col width="12%" />
<col width="15%" />
<col width="15%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">docvis</th>
<th align="center">observed</th>
<th align="center">expected</th>
<th align="center">difference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="center">1611</td>
<td align="center">264.8</td>
<td align="center">1346</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">448</td>
<td align="center">627.1</td>
<td align="center">-179.1</td>
</tr>
<tr class="odd">
<td align="center">2</td>
<td align="center">440</td>
<td align="center">796</td>
<td align="center">-356</td>
</tr>
<tr class="even">
<td align="center">3</td>
<td align="center">353</td>
<td align="center">731.6</td>
<td align="center">-378.6</td>
</tr>
<tr class="odd">
<td align="center">4</td>
<td align="center">213</td>
<td align="center">554.6</td>
<td align="center">-341.6</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="co"># Mittelwert und Varianz der jeweiligen counts</span></a>
<a class="sourceLine" id="cb25-2" data-line-number="2"><span class="co"># (f√ºr &quot;expected&quot; gilt Varianz := Mittelwert)</span></a>
<a class="sourceLine" id="cb25-3" data-line-number="3"><span class="kw">tribble</span>(</a>
<a class="sourceLine" id="cb25-4" data-line-number="4">  <span class="op">~</span>Counts,   <span class="op">~</span>Mean,                 <span class="op">~</span>Variance,</a>
<a class="sourceLine" id="cb25-5" data-line-number="5">  <span class="st">&quot;observed&quot;</span>, <span class="kw">mean</span>(rwm1984<span class="op">$</span>docvis), <span class="kw">var</span>(rwm1984<span class="op">$</span>docvis),</a>
<a class="sourceLine" id="cb25-6" data-line-number="6">  <span class="st">&quot;expected&quot;</span>, <span class="kw">mean</span>(<span class="kw">fitted</span>(mod)),    <span class="kw">mean</span>(<span class="kw">fitted</span>(mod))</a>
<a class="sourceLine" id="cb25-7" data-line-number="7">) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-8" data-line-number="8"><span class="st">  </span><span class="kw">pander</span>(<span class="dt">caption =</span> <span class="st">&quot;Mean &amp; variance of observed and expected counts&quot;</span>)</a></code></pre></div>
<table style="width:42%;">
<caption>Mean &amp; variance of observed and expected counts</caption>
<colgroup>
<col width="15%" />
<col width="11%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Counts</th>
<th align="center">Mean</th>
<th align="center">Variance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">observed</td>
<td align="center">3.163</td>
<td align="center">39.39</td>
</tr>
<tr class="even">
<td align="center">expected</td>
<td align="center">5.401</td>
<td align="center">5.401</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="co"># Plot: observed vs. expected counts</span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2">observed_v_expected <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb26-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(docvis <span class="op">&lt;=</span><span class="st"> </span><span class="dv">12</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb26-4" data-line-number="4"><span class="st">  </span><span class="kw">gather</span>(type, count, observed, expected) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb26-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> docvis, <span class="dt">y =</span> count, <span class="dt">fill =</span> type, <span class="dt">color =</span> type)) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">stroke =</span> <span class="fl">.5</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_path</span>(<span class="dt">linetype =</span> <span class="st">&quot;dotted&quot;</span>, <span class="dt">size =</span> <span class="fl">.25</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-8" data-line-number="8"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">12</span>, <span class="dv">2</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Set1&quot;</span>, <span class="dt">aesthetics =</span> <span class="kw">c</span>(<span class="st">&quot;color&quot;</span>, <span class="st">&quot;fill&quot;</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-10" data-line-number="10"><span class="st">  </span><span class="kw">labs</span>(</a>
<a class="sourceLine" id="cb26-11" data-line-number="11">    <span class="dt">title =</span> <span class="st">&quot;rwm1984: Poisson Modell&quot;</span>,</a>
<a class="sourceLine" id="cb26-12" data-line-number="12">    <span class="dt">subtitle =</span> <span class="st">&quot;Observed und expected counts bei overdispersion&quot;</span>,</a>
<a class="sourceLine" id="cb26-13" data-line-number="13">    <span class="dt">caption =</span> <span class="st">&quot;Output begrenzt auf docvs &lt;= 12&quot;</span>,</a>
<a class="sourceLine" id="cb26-14" data-line-number="14">    <span class="dt">x =</span> <span class="st">&quot;Anzahl der Arztbesuche (docvis)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Count&quot;</span></a>
<a class="sourceLine" id="cb26-15" data-line-number="15">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-16" data-line-number="16"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;top&quot;</span>)</a></code></pre></div>
<p><img src="poisson-regression_files/figure-html/diag_compare_expected-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Anhand der ersten Tabelle k√∂nnen wir recht schnell erkennen, dass wir hier <em>deutlich</em> mehr Nullen beobachten als das Modell vorhersagt ‚Äì mehr dazu in Abschnitt <a href="anwendung.html#zeros">5.2</a>.<br />
Der Plot veranschaulicht den eher suboptimalen model fit unter diesen Umst√§nden (overdispersion &amp; zero-inflation).</p>
<div id="overdisp-diag" class="section level2">
<h2><span class="header-section-number">5.1</span> Overdispersion: Erkennung und Handhabung</h2>
<p>Der <em>Score-Test</em> wird nicht unbedingt empfohlen, findet sich aber in der Literatur:</p>

<div class="definition">
<p><span id="def:unnamed-chunk-3" class="definition"><strong>Definition 5.1  (Score-Test auf Overdispersion)  </strong></span>Nach <span class="citation">Hilbe (<a href="#ref-hilbeModelingCountData2014">2014</a>)</span> (p.¬†85f):</p>
<p>Sei <span class="math inline">\(Y\)</span> die abh√§ngige Variable und <span class="math inline">\(y_i\)</span> die <span class="math inline">\(i-te\)</span> Beobachtung, mit <span class="math inline">\(\hat{\mu}_i\)</span> als gefitteter Wert eines Poisson-Modells, dann wird der z-Score wie folgt berechnet:</p>
<p>Zur Evaluation von <span class="math inline">\(z\)</span> wird z.B. ein Intercept-only Regressionsmodell mit <span class="math inline">\(z\)</span> als abh√§ngiger Variable gefitted, mit der Nullhypothese ‚ÄúEs liegt keine Overdispersion vor‚Äù.</p>
<p>Dabei gelten folgende Annahmen:</p>
<ol style="list-style-type: decimal">
<li>Die Stichprobe ist <em>gro√ü</em></li>
<li><span class="math inline">\(z\)</span> ist t-verteilt</li>
</ol>
</div>


<div class="definition">
<p><span id="def:unnamed-chunk-4" class="definition"><strong>Definition 5.2  (Lagrange Multiplier Test)  </strong></span>Nach <span class="citation">Hilbe (<a href="#ref-hilbeModelingCountData2014">2014</a>)</span> (p.¬†85f):</p>
<p>Eine <span class="math inline">\(\chi^2\)</span>-Teststatistik mit einem Freiheitsgrad.</p>
</div>

<p>Eine rudiment√§re R-Implementation findet sich in Abschnitt <a href="index.html#helperfuns">1.2.2</a>.</p>
<div id="boundary-likelihood-ratio-test-blr" class="section level3">
<h3><span class="header-section-number">5.1.1</span> (Boundary) Likelihood Ratio Test (BLR)</h3>
<p>Zum vergleich von zwei geschachtelten (<em>nested</em>) Modellen kann der <em>Likelihood Ratio Test</em> verwendet werden:</p>

<div class="definition">
<p><span id="def:LRT" class="definition"><strong>Definition 5.3  (Likelihood Ratio Test)  </strong></span><span class="math display">\[\begin{equation}
 LR = -2 (\mathcal{L}_R - \mathcal{L}_F)
\end{equation}\]</span></p>
Mit <span class="math inline">\(\mathcal{L}_F\)</span> als log-likelihood des vollen (oder ‚Äúgr√∂√üeren‚Äù) Modells, und <span class="math inline">\(\mathcal{L}_R\)</span> als log-likelihood des reduzierteren Modells.
</div>

<p>Eine Variante des Tests kann verwendet werden, um den Dispersionsparameter <span class="math inline">\(\alpha\)</span> eines NB-Modells zu testen. Da eine NB-Verteilung f√ºr <span class="math inline">\(\alpha = 0\)</span> √§quivalent zur Poisson ist (siehe Abschnitt <a href="multiparam.html#mod-nb">3.1</a>), kann ein Poisson-Modell als reduzierte Variante eines NB-Modells betrachtet werden. In diesem Fall verwendet man den <em>Boundary Likelhihood Ratio</em> test:</p>

<div class="definition">
<span id="def:BLR" class="definition"><strong>Definition 5.4  (Boundary Likelihood Ratio Test)  </strong></span><span class="math display">\[\begin{equation}
 BLR = -2 (\mathcal{L}_\mathrm{Poisson} - \mathcal{L}_\mathrm{NB})
\end{equation}\]</span>
</div>

<blockquote>
<p>It is important, though, to remember that the BLR test has a lower limiting case for the value of <span class="math inline">\(\alpha\)</span>, which is what is being tested. Given that the standard parameterization of the negative binomial variance function is <span class="math inline">\(\mu + \alpha \mu^2\)</span> , when <span class="math inline">\(\alpha = 0\)</span>, the variance reduces to <span class="math inline">\(\mu\)</span>.</p>
<p>‚Äî <span class="citation">Hilbe (<a href="#ref-hilbeModelingCountData2014">2014</a>)</span>, p.¬†115</p>
</blockquote>
<p>Der resultierende Wert ist <span class="math inline">\(\chi^2_{(1)}\)</span>-verteilt. Der resultierende p-Wert muss zus√§tzlich halbiert werden <span class="citation">(siehe Hilbe <a href="#ref-hilbeModelingCountData2014">2014</a>, p.¬†115)</span>.</p>
<blockquote>
<p>Since the distribution being tested can go no lower than 0, that is the boundary. Only one half of the full distribution is used. Therefore the Chi2 (sic!) test is divided by 2</p>
<p>‚Äî <span class="citation">Hilbe (<a href="#ref-hilbeModelingCountData2014">2014</a>)</span>, p.¬†115</p>
</blockquote>
<p>Am Beispiel der <code>rwm1984</code>-Daten:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="co"># Poisson-Modell</span></a>
<a class="sourceLine" id="cb27-2" data-line-number="2">mod_p &lt;-<span class="st"> </span><span class="kw">glm</span>(docvis <span class="op">~</span><span class="st"> </span>outwork <span class="op">+</span><span class="st"> </span>age, <span class="dt">family =</span> <span class="kw">poisson</span>(), <span class="dt">data =</span> rwm1984)</a>
<a class="sourceLine" id="cb27-3" data-line-number="3"></a>
<a class="sourceLine" id="cb27-4" data-line-number="4"><span class="co"># NB-Modell</span></a>
<a class="sourceLine" id="cb27-5" data-line-number="5">mod_nb &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw">glm.nb</span>(docvis <span class="op">~</span><span class="st"> </span>outwork <span class="op">+</span><span class="st"> </span>age, <span class="dt">data =</span> rwm1984)</a>
<a class="sourceLine" id="cb27-6" data-line-number="6"></a>
<a class="sourceLine" id="cb27-7" data-line-number="7"><span class="co"># BLR: Recht eindeutig.</span></a>
<a class="sourceLine" id="cb27-8" data-line-number="8">lmtest<span class="op">::</span><span class="kw">lrtest</span>(mod_p, mod_nb)</a></code></pre></div>
<div class="kable-table">

<table>
<thead>
<tr>
<th style="text-align:right;">
#Df
</th>
<th style="text-align:right;">
LogLik
</th>
<th style="text-align:right;">
Df
</th>
<th style="text-align:right;">
Chisq
</th>
<th style="text-align:right;">
Pr(&gt;Chisq)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
-15636.390
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
-8332.762
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
14607.26
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="co"># Bei gegebenem BLR-Wert von 4.2 lie√üe sich der p-Wert wie folgt berechnen:</span></a>
<a class="sourceLine" id="cb28-2" data-line-number="2"><span class="kw">pchisq</span>(<span class="fl">4.2</span>, <span class="dt">df =</span> <span class="dv">1</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">2</span></a></code></pre></div>
<pre><code>#&gt; [1] 0.02021199</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="co"># Oder</span></a>
<a class="sourceLine" id="cb30-2" data-line-number="2">(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pchisq</span>(<span class="fl">4.2</span>, <span class="dt">df =</span> <span class="dv">1</span>)) <span class="op">/</span><span class="st"> </span><span class="dv">2</span></a></code></pre></div>
<pre><code>#&gt; [1] 0.02021199</code></pre>
</div>
<div id="umgang-mit-overdispersion" class="section level3">
<h3><span class="header-section-number">5.1.2</span> Umgang mit Overdispersion</h3>
<p>Zur expliziten Modellierung des Dispersionparameters kann ein NBH Modell (<a href="weitere-modelle.html#mod-nbh">4.1.1</a>) genutzt werden, falls die Quelle der overdispersion von besonderem Interesse ist.</p>
<p>Abseits davon bleiben 2 grobe Strategien :</p>
<ol style="list-style-type: decimal">
<li>Adjustierung der durch die overdispersion verzerrten Standardfehler (Quasipoisson, Quasi-Likelihood, robuste Varianzsch√§tzer)</li>
<li>Wechsel auf ein Modell, das overdispersion (oder allgemeine extradispersion) erlaubt (e.g.¬†NB)</li>
</ol>
<p>(Bemerke: Standardfehler f√ºr IRRs werden i.A. √ºber die <em>delta method</em> bestimmt, die ich noch recherchieren und irgendwo einbauen muss)</p>
<div id="quasipoisson-skalierung-der-standardfehler" class="section level5 unnumbered">
<h5>Quasipoisson: Skalierung der Standardfehler</h5>
<p>Hier werden lediglich die Standardfehler der Koeffizienten eines Poisson-Modells adjustiert, die bei overdispersion i.d.R. untersch√§tzt werden ‚Äì die eigentliche Parametersch√§tzung wird nicht beeinflusst:</p>
<p><span class="math display">\[\mathrm{SE}(\beta_k) \cdot \sqrt{D}\]</span>
Wobei <span class="math inline">\(D\)</span> der Pearson-Dispersionsindex ist (vgl. <span class="citation">Hilbe (<a href="#ref-hilbeModelingCountData2014">2014</a>)</span>, p.¬†92ff), den wir in <a href="poisson-modell.html#def:def-pearsondisp">2.5</a> als <span class="math inline">\(\frac{\chi^2_{\mathrm{Pearson}}}{\mathrm{df}}\)</span> definiert hatten.</p>
<p>Ein m√∂glicher Nachteil jedoch: Es wird zuerst ein regul√§res Poisson-Modell gefittet, Standardfehler und Dispersionsindex bestimmt, und dann dasselbe Modell mit skalierten Standardfehlern erneut gefittet ‚Äì dementsprechend ist diese Methode vermutlich f√ºr gr√∂√üere Datens√§tze eher ineffizient.</p>
<p>Einmal auf unser voriges Beispiel anhand der <code>rwm5yr</code>-Daten angewandt:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="co"># Urpr√ºngliches Model</span></a>
<a class="sourceLine" id="cb32-2" data-line-number="2">mod &lt;-<span class="st"> </span><span class="kw">glm</span>(docvis <span class="op">~</span><span class="st"> </span>outwork <span class="op">+</span><span class="st"> </span>age, <span class="dt">family =</span> <span class="kw">poisson</span>(), <span class="dt">data =</span> rwm1984)</a>
<a class="sourceLine" id="cb32-3" data-line-number="3"></a>
<a class="sourceLine" id="cb32-4" data-line-number="4">mod_qp &lt;-<span class="st"> </span><span class="kw">glm</span>(docvis <span class="op">~</span><span class="st"> </span>outwork <span class="op">+</span><span class="st"> </span>age, <span class="dt">family =</span> <span class="kw">quasipoisson</span>(), <span class="dt">data =</span> rwm1984)</a>
<a class="sourceLine" id="cb32-5" data-line-number="5"></a>
<a class="sourceLine" id="cb32-6" data-line-number="6"><span class="kw">dispersion</span>(mod)</a></code></pre></div>
<pre><code>#&gt; X-squared(3871) = 43909.62
#&gt; Pearson Dispersion = 11.343</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="kw">dispersion</span>(mod_qp)</a></code></pre></div>
<pre><code>#&gt; X-squared(3871) = 43909.62
#&gt; Pearson Dispersion = 11.343</code></pre>
<p>An der Dispersion hat sich nichts ge√§ndert, nur an den Standardfehlern der Koeffizienten (in folgenden Tabellen auf log-Skala):</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="kw">pander</span>(mod, <span class="dt">caption =</span> <span class="st">&quot;Poisson-Modell&quot;</span>)</a></code></pre></div>
<table style="width:90%;">
<caption>Poisson-Modell</caption>
<colgroup>
<col width="25%" />
<col width="15%" />
<col width="18%" />
<col width="13%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">¬†</th>
<th align="center">Estimate</th>
<th align="center">Std. Error</th>
<th align="center">z value</th>
<th align="center">Pr(&gt;|z|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>(Intercept)</strong></td>
<td align="center">-0.03352</td>
<td align="center">0.03918</td>
<td align="center">-0.8554</td>
<td align="center">0.3923</td>
</tr>
<tr class="even">
<td align="center"><strong>outwork</strong></td>
<td align="center">0.4079</td>
<td align="center">0.01884</td>
<td align="center">21.65</td>
<td align="center">6.481e-104</td>
</tr>
<tr class="odd">
<td align="center"><strong>age</strong></td>
<td align="center">0.02208</td>
<td align="center">0.0008377</td>
<td align="center">26.36</td>
<td align="center">3.73e-153</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="kw">pander</span>(mod_qp, <span class="dt">caption =</span> <span class="st">&quot;Quasipoisson-Modell&quot;</span>)</a></code></pre></div>
<table style="width:89%;">
<caption>Quasipoisson-Modell</caption>
<colgroup>
<col width="25%" />
<col width="15%" />
<col width="18%" />
<col width="13%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">¬†</th>
<th align="center">Estimate</th>
<th align="center">Std. Error</th>
<th align="center">t value</th>
<th align="center">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>(Intercept)</strong></td>
<td align="center">-0.03352</td>
<td align="center">0.132</td>
<td align="center">-0.254</td>
<td align="center">0.7995</td>
</tr>
<tr class="even">
<td align="center"><strong>outwork</strong></td>
<td align="center">0.4079</td>
<td align="center">0.06347</td>
<td align="center">6.427</td>
<td align="center">1.457e-10</td>
</tr>
<tr class="odd">
<td align="center"><strong>age</strong></td>
<td align="center">0.02208</td>
<td align="center">0.002821</td>
<td align="center">7.827</td>
<td align="center">6.386e-15</td>
</tr>
</tbody>
</table>
<p>In diesem Fall ‚Äúlohnt‚Äù sich dieser Ansatz zwar eher nicht, da wir neben overdispersion noch ein Problem mit zero-inflation haben, aber in manchen F√§llen kann Quasipoisson-Methode ausreichen.</p>
<blockquote>
<p>‚ÄúScaling is an easy, quick-and-dirty method of adjusting standard errors for overdispersion. However, when data are highly correlated or clustered, model slopes or coefficients usually need to be adjusted as well. Scaling does not accommodate that need, but simulations demonstrate that it is quite useful for models with little to moderate overdispersion.‚Äù</p>
<p>‚Äî <span class="citation">Hilbe (<a href="#ref-hilbeModelingCountData2014">2014</a>)</span> (p.¬†96)</p>
</blockquote>
</div>
<div id="sandwich" class="section level4">
<h4><span class="header-section-number">5.1.2.1</span> Robuste Varianzsch√§tzer (Sandwich Estimators)</h4>
<p>(Andere Namen: Huber &amp; White standard errors, empirical standard errors)</p>
<p>Sandwich estimators sind in erster Linie f√ºr nicht unabh√§ngige bzw. korrellierte Daten gedacht, zum Beispiel f√ºr Daten, die innerhalb mehrere Haushalte, Krankenh√§user, St√§dte etc. gesammelt wurden.</p>
<p>Robuste Varianzsch√§tzer k√∂nnen (und je nach Quelle: <em>sollten</em>) standardm√§√üig f√ºr Count-response Daten verwendet werden, da die resultierenden Sch√§tzer im Falle tats√§chlich unkorrellierter Daten √§quivalent zu den Standardfehlern des urspr√ºnglichen Modells sind (i.e. ‚Äúschadet nicht‚Äù).</p>
<p>Bootstrapped SEs wiederum erfordern mehr Aufwand, √§hneln aber den robusten SEs sowieso sehr stark, weshalb sich der Aufwand ggf. nicht wirklich lohnt.</p>
<p>Siehe <span class="citation">Hilbe (<a href="#ref-hilbeModelingCountData2014">2014</a>)</span> (p.¬†99f) f√ºr eine ausf√ºhrlichere Beschreibung. Zudem gibt der Autor explizit den Rat:</p>
<blockquote>
<p>‚ÄúUnless your Poisson or negative binomial model is well fitted and meets its respective distributional assumptions, use robust or empirical standard errors as a default‚Äù</p>
<p>‚Äî <span class="citation">Hilbe (<a href="#ref-hilbeModelingCountData2014">2014</a>)</span> (p.¬†133)</p>
</blockquote>
</div>
</div>
</div>
<div id="zeros" class="section level2">
<h2><span class="header-section-number">5.2</span> Zero-Inflation (ZI)</h2>
<p>Problem: ‚ÄúExcess zeros‚Äù, i.e.¬†das Modell sagt f√ºr <span class="math inline">\(P(y_i = 0\ |\ x_i)\)</span> eine deutlich kleinere Wahrscheinlichkeit vor, als in gegebenen Daten tats√§chlich vorliegen.</p>
<p>Zero-inflation h√§ngt eng mit overdispersion zusammen. Sie <em>kann</em> Ursache f√ºr overdispersion sein, allerdings bedeutet das nicht direkt, dass auch ein entsprechend auf <em>ZI</em>-fokussiertes Modell (ZIP, ZINB‚Ä¶) verwendet werden <em>muss</em> ‚Äì ggf. l√§sst sich die overdispersion bereits durch ein anderes geeignetes Modell ‚Äúauffangen‚Äù. Zum Beispiel zeigt <span class="citation">Winkelmann (<a href="#ref-winkelmannEconometricAnalysisCount2010">2010</a>)</span>, dass die <em>NB</em> allgemein eine gr√∂√üere Anzahl an Nullen erwartet als die Poisson.</p>
<p><img src="poisson-regression_files/figure-html/excess_zeros_viz-1.png" width="768" style="display: block; margin: auto;" /></p>
<div id="vergleich-von-zero-inflated-models" class="section level3 unnumbered">
<h3>Vergleich von Zero-Inflated models</h3>
<p>Zum Vergleich zwischen Z√§hlmodellen und ihren zero-inflated Gegenst√ºcken (e.g.¬†Poisson vs.¬†ZIP oder NB vs.¬†ZINB) wird in der Literatur h√§ufig der Vuong-Test <span class="citation">(Vuong <a href="#ref-vuongLikelihoodRatioTests1989">1989</a>; Desmarais und Harden <a href="#ref-desmarais2013TestingZero">2013</a>)</span> verwendet. Dieser Test ist explizit f√ºr den Vergleich von <strong>un</strong>geschachtelten Modellen entworfen (im Gegensatz zu z.B. dem Likelihood Ratio test). <span class="citation">Wilson (<a href="#ref-wilson2015MisuseVuong">2015</a>)</span> kritisiert dieses Vorgehen mit der Begr√ºndung (und Demonstration), dass zero-inflated Modelle <em>nicht</em> ungeschachtelt mit ihren urspr√ºnglichen Z√§hmodellen sind. Auch <span class="citation">Perumean-Chaney u.¬†a. (<a href="#ref-perumean-chaneyZeroinflatedOverdispersedWhat2013">2013</a>)</span> und <span class="citation">Hilbe (<a href="#ref-hilbeModelingCountData2014">2014</a>)</span>, die in diesem Dokument mehrfach zitiert werden, verwenden den Vuong-Test auf diese Weise.</p>
<p>Das Paper (<span class="citation">Wilson (<a href="#ref-wilson2015MisuseVuong">2015</a>)</span>) ist recht kurz und definitiv einen Blick Wert, insbesondere da ich (Lukas) mir bisher nicht zutraue zu beurteilen, wer in dieser Frage ‚ÄúRecht‚Äù hat.</p>
<blockquote>
<p>The misuse of the test stems from misunderstanding of what is meant by the terms ‚Äúnon-nested model‚Äù and ‚Äúnested model‚Äù. As is the case with many frequently used terms their meanings are approximately understood by many, but precisely understood by few.</p>
<p>‚Äî <span class="citation">Wilson (<a href="#ref-wilson2015MisuseVuong">2015</a>)</span>, p.¬†52</p>
</blockquote>
</div>
<div id="modellierung" class="section level3 unnumbered">
<h3>Modellierung</h3>
<p>F√ºr die Modellierung von zero-inflated Daten stehen prim√§r zwei M√∂glichkeiten zur Verf√ºgung (vgl. auch <span class="citation">Hilbe (<a href="#ref-hilbeModelingCountData2014">2014</a>)</span>, p.¬†19):</p>
<ol style="list-style-type: decimal">
<li><em>Zero-inflated models</em>: Mixture models, die aus zwei Wahrscheinlichkeitsfunktionen eine neue Wahrscheinlichkeitsfunktion generieren, die sowohl Nullen als auch positive counts beschreibt, allerdings nun auch einen <em>zero-inflation</em>-Parameter hat (siehe Abschnitt <a href="weitere-modelle.html#mod-zi">4.2</a>).</li>
<li><em>Hurdle models</em>: Getrennte Modellierung von Nullen und positiven counts in zwei separaten Modellen (siehe Abschnitt <a href="erganzungen.html#mod-hurdle">B.3</a>).</li>
</ol>
<p>Ob hurdle model oder zero-inflated model die bessere Wahl ist h√§ngt mitunter davon ab, welche Annahmen √ºber die <em>Ursache der Nullen</em> getroffen werden k√∂nnen.<br />
Wenn es eine echte Trennung der Mechanismen (<em>‚Äúseparation of mechanisms‚Äù</em>) gibt, die die Nullen und die positiven counts verursachen, dann w√§re ein hurdle model eher angemessen.<br />
Wenn sich die Nullen √ºberlappen, es also keine getrennten Prozesse zu geben scheint, dann w√§ren zero-inflated models angemessen <span class="citation">(Hilbe <a href="#ref-hilbeModelingCountData2014">2014</a>, p.¬†209)</span>.</p>
<p>Als Veranschaulichung f√ºr zwei sich √ºberlappende Mechanismen k√∂nnen wir das <em>fish</em>-Beispiel auf <a href="https://stats.idre.ucla.edu/sas/output/zero-inflated-poisson-regression/">dieser UCLA-Tutorialseite verwenden</a>. Hier ist die Anzahl der gefangenen Fische an einem Wochenende in einem Park die Z√§hlvariable.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="co"># Mittelwert &amp; Varianz von &#39;count&#39;</span></a>
<a class="sourceLine" id="cb38-2" data-line-number="2"><span class="kw">describe_counts</span>(fish<span class="op">$</span>count)</a></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
N
</th>
<th style="text-align:right;">
Missing
</th>
<th style="text-align:right;">
Mittelwert
</th>
<th style="text-align:right;">
Varianz
</th>
<th style="text-align:left;">
Range
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
250
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3.3
</td>
<td style="text-align:right;">
135.37
</td>
<td style="text-align:left;">
[0, 149]
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="co"># Barchart f√ºr counts &lt;= 50, Spannweite sehr gro√ü</span></a>
<a class="sourceLine" id="cb39-2" data-line-number="2">fish <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb39-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(count <span class="op">&lt;=</span><span class="st"> </span><span class="dv">50</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb39-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> count)) <span class="op">+</span></a>
<a class="sourceLine" id="cb39-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">alpha =</span> <span class="fl">.75</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb39-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_x_continuous</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb39-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>(</a>
<a class="sourceLine" id="cb39-8" data-line-number="8">    <span class="dt">title =</span> <span class="st">&quot;&#39;fish&#39;: Anzahl gefangener Fische&quot;</span>,</a>
<a class="sourceLine" id="cb39-9" data-line-number="9">    <span class="dt">subtitle =</span> <span class="st">&quot;Limitiert auf counts unter 50&quot;</span>,</a>
<a class="sourceLine" id="cb39-10" data-line-number="10">    <span class="dt">x =</span> <span class="st">&quot;Anzahl gefangener Fischer&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Count&quot;</span></a>
<a class="sourceLine" id="cb39-11" data-line-number="11">  )</a></code></pre></div>
<p><img src="poisson-regression_files/figure-html/fishing_zeros-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Die Anzahl der Nullen ist hier auffallend gro√ü ‚Äì allerdings beobachten wir hier auch zwei unterschiedliche Mechanismen, die sich √ºberlappen: Eine Gruppe kann das ganze Wochenende geangelt haben, w√§hrend eine andere Gruppe gar nicht geangelt hat ‚Äì beide Gruppen werden jedoch am Ende nach der Anzahl ihrer gefangenen Fische befragt, weshalb wir in den Daten Nullen mit unterschiedlichem ‚ÄúUrsprung‚Äù erhalten</p>
<p>Da es hier nicht angemessen w√§re, die Nullen und die positiven counts getrennt zu Modellieren, w√ºrden wir hier ein <em>zero-inflated</em> Modell (z.B ZIP, ZINB, ‚Ä¶) verwenden.</p>

</div>
</div>
</div>
<h3>Literatur</h3>
<div id="refs" class="references">
<div id="ref-desmarais2013TestingZero">
<p>Desmarais, Bruce A., und Jeffrey J. Harden. 2013. ‚ÄûTesting for Zero Inflation in Count Models: Bias Correction for the Vuong Test‚Äú. <em>The Stata Journal</em> 13 (4): 810‚Äì35. <a href="https://doi.org/10.1177/1536867X1301300408" class="uri">https://doi.org/10.1177/1536867X1301300408</a>.</p>
</div>
<div id="ref-hilbeModelingCountData2014">
<p>Hilbe, Joseph M. 2014. <em>Modeling Count Data</em>. Cambridge: Cambridge University Press. <a href="https://doi.org/10.1017/CBO9781139236065" class="uri">https://doi.org/10.1017/CBO9781139236065</a>.</p>
</div>
<div id="ref-perumean-chaneyZeroinflatedOverdispersedWhat2013">
<p>Perumean-Chaney, Suzanne E., Charity Morgan, David McDowall, und Inmaculada Aban. 2013. ‚ÄûZero-Inflated and Overdispersed: What‚Äôs One to Do?‚Äú <em>Journal of Statistical Computation and Simulation</em> 83 (9): 1671‚Äì83. <a href="https://doi.org/10.1080/00949655.2012.668550" class="uri">https://doi.org/10.1080/00949655.2012.668550</a>.</p>
</div>
<div id="ref-vuongLikelihoodRatioTests1989">
<p>Vuong, Quang H. 1989. ‚ÄûLikelihood Ratio Tests for Model Selection and Non-Nested Hypotheses‚Äú. <em>Econometrica</em> 57 (2): 307. <a href="https://doi.org/10.2307/1912557" class="uri">https://doi.org/10.2307/1912557</a>.</p>
</div>
<div id="ref-wilson2015MisuseVuong">
<p>Wilson, Paul. 2015. ‚ÄûThe Misuse of the Vuong Test for Non-Nested Models to Test for Zero-Inflation‚Äú. <em>Economics Letters</em> 127 (Februar): 51‚Äì53. <a href="https://doi.org/10.1016/j.econlet.2014.12.029" class="uri">https://doi.org/10.1016/j.econlet.2014.12.029</a>.</p>
</div>
<div id="ref-winkelmannEconometricAnalysisCount2010">
<p>Winkelmann, Rainer. 2010. <em>Econometric Analysis of Count Data</em>. 5th ed. Berlin: Springer Berlin.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="weitere-modelle.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="entscheidungshilfen.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["poisson-regression.pdf", "poisson-regression.tex", "poisson-regression.epub"],
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
